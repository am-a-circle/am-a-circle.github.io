<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Automobile Hacking - Part 2" /><meta name="author" content="am-a-circle" /><meta property="og:locale" content="en" /><meta name="description" content="Setting Up can-utils to Connect to CAN Devices" /><meta property="og:description" content="Setting Up can-utils to Connect to CAN Devices" /><link rel="canonical" href="https://am-a-circle.github.io//posts/CarPT-Part2/" /><meta property="og:url" content="https://am-a-circle.github.io//posts/CarPT-Part2/" /><meta property="og:site_name" content="am-a-circle" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-05-10T09:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automobile Hacking - Part 2" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@am-a-circle" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"am-a-circle"},"headline":"Automobile Hacking - Part 2","dateModified":"2023-08-01T21:04:44+08:00","datePublished":"2023-05-10T09:55:00+08:00","description":"Setting Up can-utils to Connect to CAN Devices","url":"https://am-a-circle.github.io//posts/CarPT-Part2/","mainEntityOfPage":{"@type":"WebPage","@id":"https://am-a-circle.github.io//posts/CarPT-Part2/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Automobile Hacking - Part 2 | am-a-circle</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="am-a-circle"><meta name="application-name" content="am-a-circle"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">am-a-circle</a></div><div class="site-subtitle font-italic">Logs of my roots.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/privesc/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PRIVESC</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-a-circle" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Automobile Hacking - Part 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Automobile Hacking - Part 2</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> am-a-circle </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, May 10, 2023, 9:55 AM +0800" >May 10, 2023<i class="unloaded">2023-05-10T09:55:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 1, 2023, 9:04 PM +0800" >Aug 1, 2023<i class="unloaded">2023-08-01T21:04:44+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3636 words">20 min read</span></div></div><div class="post-content"><h1 id="setting-up-can-utils-to-connect-to-can-devices">Setting Up can-utils to Connect to CAN Devices</h1><p>Welcome to the second post in our blog series on car penetration testing. In this post, we will explore how to set up and utilize the powerful can-utils tool to connect to CAN devices, monitor the network, and analyze the data flowing through it.</p><p>Before we dive into setting up can-utils, let’s take a quick look at the roadmap for this series:</p><ol><li><p><strong>Exploring the Inner Workings of the Controller Area Network (CAN) Bus Protocol</strong>: In the previous post, we discussed the basics of the CAN Bus protocol.</p><li><p><strong>Setting Up can-utils to Connect to CAN Devices</strong>: (THIS POST) We will learn how to install and configure can-utils to interact with CAN devices and perform various tasks such as sending and receiving CAN packets.</p><li><p><strong>Unraveling the Process of Reverse Engineering the CAN Bus</strong>: Reverse engineering is a crucial skill in car penetration testing. In this post, we’ll delve into the fascinating world of reverse engineering the CAN Bus, where we’ll analyze and understand the data exchanged between different components in a vehicle.</p><li><p><strong>Venturing Into the Realm of ECU Hacking</strong>: Electronic Control Units (ECUs) are the brains behind various vehicle systems. In this post, we’ll explore the vulnerabilities that exist within ECUs and how to exploit them for hacking purposes. We’ll uncover techniques to gain control over these crucial components and potentially manipulate their behavior.</p></ol><p>Through this exploration, my aim is to share practical knowledge about automotive cybersecurity. By the end of this series, you’ll have a solid foundation in car penetration testing, enabling you to identify vulnerabilities, understand potential attack vectors, and contribute to the ongoing efforts to secure vehicles in the digital age.</p><p>Now, let’s get started with setting up can-utils to connect to CAN devices.</p><h2 id="setting-up-can-utils-to-connect-to-can-devices-1">Setting Up can-utils to Connect to CAN Devices</h2><p>To connect to CAN devices using can-utils, you need to set up the necessary dependencies and configure the tools accordingly. Here’s a step-by-step guide on setting up can-utils on a Kali Linux instance:</p><h3 id="installing-can-utils">Installing can-utils</h3><p>First, you need to install the required libraries by running the following commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>sudo apt install libsdl2 dev
sudo apt install libsdl2 image dev
sudo apt install can utils
</pre></table></code></div></div><h3 id="overview-of-can-utils">Overview of can-utils</h3><p>Once can-utils is installed and ready, let’s take a high-level look at some of the can-utils tools available:</p><ol><li><strong>cangen</strong>: This command generates CAN packets and allows you to transmit them at specified intervals. It also has the capability to generate random packets.<li><strong>candump</strong>: This utility dumps CAN packets. You can apply filters and log packets using this tool.<li><strong>cansniffer</strong>: It is an interactive sniffer that groups packets by ID and highlights changed bytes.<li><strong>canplayer</strong>: This command replays packets saved in the standard SocketCAN “compact” format.<li><strong>cansend</strong>: This tool sends a single CAN frame to the CAN network.</ol><h3 id="setting-up-a-virtual-can-network">Setting Up a Virtual CAN Network</h3><p>If you don’t have physical CAN hardware for testing, you can set up a virtual CAN network. To do so, follow these steps:</p><p>Load the vcan module by running the command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─$ sudo modprobe vcan
</pre></table></code></div></div><p>When you check the <code class="language-plaintext highlighter-rouge">dmesg</code> output, you should see a message like this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>   └─$ dmesg
    [  211.036166] CAN device driver interface
    [  211.036956] vcan: Virtual CAN interface driver
</pre></table></code></div></div><p>Proceed with the following commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>└─$ sudo ip link add dev vcan0 type vcan
└─$ sudo ip link set up vcan0
</pre></table></code></div></div><p>To verify if the setup is successful, enter the command. If the output shows <code class="language-plaintext highlighter-rouge">vcan0</code> with the flags <code class="language-plaintext highlighter-rouge">UP,RUNNING,NOARP</code>, you are ready to go:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> └─$ ifconfig vcan0
vcan0: flags=193&lt;UP,RUNNING,NOARP&gt;  mtu 72
        unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 1000  (UNSPEC)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</pre></table></code></div></div><p>Seeing <code class="language-plaintext highlighter-rouge">vcan0</code> in the output confirms that your virtual CAN network is set up correctly.</p><p>With can-utils installed and the CAN network configured, you are now ready to connect to CAN devices and utilize the various can-utils tools for the next few steps!</p><h2 id="simulating-realistic-background-noise-with-the-instrument-cluster-simulator">Simulating Realistic Background Noise with the Instrument Cluster Simulator</h2><p>The instrument cluster simulator (ICSim) is a valuable software utility that generates essential CAN signals, creating a rich background of “normal” CAN noise. Its purpose is to provide a safe and convenient environment for practicing CAN bus reversing without the need to tinker with your actual car. The skills you develop using ICSim will directly translate to working with real vehicles, ensuring a smooth transition.</p><p>To get started, visit the ICSim GitHub repository at <a href="https://github.com/zombieCraig/ICSim">https://github.com/zombieCraig/ICSim</a> and download the source code. Refer to the provided README file for instructions on how to compile the software. Follow the steps carefully to prepare for an effective learning experience.</p><p>Before launching ICSim, ensure that you have already set up a vcan0 interface using the <code class="language-plaintext highlighter-rouge">setup_vcan.sh</code> script mentioned in the README. If you haven’t done so, please refer to the previous step for guidance. This setup is necessary and straightforward.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>└─$ cat setup_vcan.sh 
sudo modprobe can
sudo modprobe vcan
sudo ip link add dev vcan0 type vcan
sudo ip link set up vcan0
</pre></table></code></div></div><p>Now, let’s explore ICSim! It consists of two components: icsim and controls, which communicate over a CAN bus. Begin by loading the instrument cluster onto the vcan device with the following command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─$ ./icsim vcan0 &amp;
</pre></table></code></div></div><p>As ICSim starts running, you will witness the instrument cluster come alive on your screen. It will display turn signals, a speedometer, and a car image that represents the locking and unlocking of the car doors.</p><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/icsim-car-speedometer.png?raw=true" alt="enter image description here" /></p><p>Initially, the ICSim application may not show any activity since it solely listens for CAN signals. To control the simulator, launch the CANBus Control Panel by executing the following command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─$ ./controls vcan0 &amp;
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/canbus.png?raw=true" alt="enter image description here" /></p><p>The CANBus Control Panel, resembling a game controller, will appear on your screen. If you prefer, you can connect a USB game controller, which is supported by ICSim. Alternatively, you can operate the simulator using your keyboard.</p><p>Familiarize yourself with the primary controls on the CANBus Control Panel:</p><p><strong>Accelerate (up arrow)</strong>: Press this to increase the speedometer reading. Holding the key down will make the virtual vehicle go faster.</p><p><strong>Turn (left/right arrows)</strong>: Hold down the respective arrow key to activate the turn signals.</p><p><strong>Lock (left shift), Unlock (right shift)</strong>: This control requires pressing two buttons simultaneously. Hold down the left shift and press one of the buttons (A, B, X, or Y) to lock a corresponding door. Similarly, hold down the right shift and press a button to unlock a door. If you hold down the left shift and then press the right shift, it will unlock all the doors. Conversely, holding down the right shift and pressing the left shift will lock all the doors.</p><p>Arrange your screen to have both the ICSim and the CANBus Control Panel visible simultaneously. This way, you can observe their interaction. Ensure that the control panel is selected and ready to receive input. Experiment with the controls to observe the real-time response of ICSim. If you encounter any issues, make sure that the ICSim control window is selected and active.</p><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/together.png?raw=true" alt="enter image description here" /></p><p>With ICSim up and running, alongside the intuitive CANBus Control Panel, we are now equipped to explore the world of CAN bus reversing with confidence.</p><h2 id="dumping-can-frames-and-performing-a-replay-attack">Dumping CAN Frames and Performing a Replay Attack</h2><p>In this section, we will explore how to dump CAN frames using CAN utils tools and conduct a simple replay attack.</p><p>Once you have successfully set up ICSim as instructed in the previous section and verified its proper functioning, it’s time to capture and analyze the CAN bus traffic. You can achieve this by running the <code class="language-plaintext highlighter-rouge">candump</code> command with the <code class="language-plaintext highlighter-rouge">vcan0</code> interface. Take a look at the example below:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim]                                                                                                                                                                                                                                                                                                                                                                                                                                                             
└─$ candump vcan0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  vcan0  1DC   [4]  02 00 00 39
  vcan0  183   [8]  00 00 00 0C 00 00 10 2D
  vcan0  143   [4]  6B 6B 00 E0
  ...
  vcan0  21E   [7]  03 E8 37 45 22 06 01
</pre></table></code></div></div><h2 id="dumping-can-frames-and-performing-a-replay-attack-1">Dumping CAN Frames and Performing a Replay Attack</h2><p>In this section, we will explore how to dump CAN frames using CAN utils tools and conduct a simple replay attack.</p><p>Once you have successfully set up ICSim as instructed in the previous section and verified its proper functioning, it’s time to capture and analyze the CAN bus traffic. You can achieve this by running the <code class="language-plaintext highlighter-rouge">candump</code> command with the <code class="language-plaintext highlighter-rouge">vcan0</code> interface. Take a look at the example below:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim]
└─$ candump vcan0

vcan0  1DC   [4]  02 00 00 39
vcan0  183   [8]  00 00 00 0C 00 00 10 2D
vcan0  143   [4]  6B 6B 00 E0
...
vcan0  21E   [7]  03 E8 37 45 22 06 01 
</pre></table></code></div></div><p>In the above output, you will notice an “interface” column, where it indicates “vcan0.” This signifies that we are capturing all the packets on the <code class="language-plaintext highlighter-rouge">vcan0</code> interface. Next, there is a “message identifier” column, followed by the “size” column, which represents the size of the data in each frame. For example, “seven” indicates seven bytes of data, “four” represents four bytes of data, and “eight” signifies eight bytes of data. The following column displays the actual data, while the last column indicates the size of the data.</p><p>Now, using the <code class="language-plaintext highlighter-rouge">candump</code> tool, we will log the captured CAN packets to prepare for executing a replay attack. Run the following command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>└─$ sudo candump -l vcan0
Disabled standard output while logging.
Enabling Logfile 'candump-2023-05-19_024025.log
</pre></table></code></div></div><p>By executing the above command, we log the CAN packets and store them in a logfile named <code class="language-plaintext highlighter-rouge">candump-2023-05-19_023210.log</code> for later use.</p><p>To perform the replay attack, let’s utilize the <code class="language-plaintext highlighter-rouge">canplayer</code> tool. Execute the following command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim]
└─$ canplayer -I candump-2023-05-19_024025.log 
</pre></table></code></div></div><p>Observing the ICSim, you will notice that the accelerometer is changing the speed, the turn signals are activating, and the doors are opening and closing. The replayed CAN packets effectively replicate the recorded actions.</p><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/post2/replay.jpg?raw=true" alt="enter image description here" /></p><p>In summary, by utilizing the <code class="language-plaintext highlighter-rouge">candump</code> and <code class="language-plaintext highlighter-rouge">canplayer</code> tools, we were able to capture CAN frames, log them, and subsequently execute a replay attack on the ICSim. This allows us to simulate and observe the desired actions on the instrument cluster, replicating the recorded CAN traffic.</p><h2 id="recursive-splitting-method-for-finding-can-frames">Recursive Splitting Method for Finding CAN Frames</h2><p>In this section, we will explore the Recursive Splitting Method to identify a specific CAN frame responsible for opening the ICSim back left door.</p><p>To begin, use the <code class="language-plaintext highlighter-rouge">candump</code> command to record the CAN frames when you open the back left door:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim]
└─$ sudo candump -l vcan0
Disabled standard output while logging.
Enabling Logfile 'candump-2023-05-19_025921.log'
</pre></table></code></div></div><p>Executing the above command will log the CAN frames into a file named <code class="language-plaintext highlighter-rouge">candump-2023-05-19_025921.log</code>.</p><p>To determine the number of lines in the log file, use the <code class="language-plaintext highlighter-rouge">wc</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>└─$ wc -l candump-2023-05-19_025921.log 
16706 candump-2023-05-19_025921.log
</pre></table></code></div></div><p>From the output, we can see that the log file contains a total of 16,706 lines.</p><p>Next, we will split the log file into two halves using the <code class="language-plaintext highlighter-rouge">split</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>└─$ sudo split -l 8500  candump-2023-05-19_025921.log split_door
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ ls -la
total 1452
drwxr-xr-x 2 root root   4096 May 19 03:03 .
drwxr-xr-x 6 root root   4096 May 19 03:01 ..
-rw-r--r-- 1 root root 736994 May 19 02:59 candump-2023-05-19_025921.log
-rw-r--r-- 1 root root 374938 May 19 03:03 split_dooraa
-rw-r--r-- 1 root root 362056 May 19 03:03 split_doorab
</pre></table></code></div></div><p>This command splits the log file into two separate files, namely <code class="language-plaintext highlighter-rouge">split_dooraa</code> and <code class="language-plaintext highlighter-rouge">split_doorab</code>.</p><p>To determine which of these files contains the CAN frame responsible for opening the door, we can use the <code class="language-plaintext highlighter-rouge">canplayer</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ canplayer -I split_dooraa                 
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ canplayer -I split_doorab
</pre></table></code></div></div><p>Execute the above commands to play the CAN frames from each file and observe the result. Based on my specific example, the <code class="language-plaintext highlighter-rouge">split_doorab</code> file contains the CAN frame required to open the back left door.</p><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/post2/split_door_open.jpg?raw=true" alt="enter image description here" /></p><p>Continuing with the recursive splitting method, we repeat the process by splitting the <code class="language-plaintext highlighter-rouge">split_doorab</code> file into smaller parts,Once again, we use <code class="language-plaintext highlighter-rouge">canplayer</code> to verify which file contains the desired CAN frame:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ sudo split -l 4000  split_doorab split_door_2
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ canplayer -I split_door_2aa
</pre></table></code></div></div><p>At this point, the process is repeated, splitting the file further and analyzing the resulting parts until a smaller file size is achieved. This iterative approach involves verifying which file contains the relevant CAN frame.</p><p>For example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim/split]                                                                         
└─$ sudo split -l 500 split_door_2aa split_door_3                                                          
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]                                                                         
└─$ ls                                                                                                     
candump-2023-05-19_025921.log  split_door_2ac  split_door_3ac  split_door_3af  split_dooraa                
split_door_2aa                 split_door_3aa  split_door_3ad  split_door_3ag  split_doorab                
split_door_2ab                 split_door_3ab  split_door_3ae  split_door_3ah  

┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ canplayer -I split_door_4aj
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ wc -l split_door_4aj                        
50 split_door_4aj
</pre></table></code></div></div><p>Continue this process until you reach a file size that can be easily inspected. For instance:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ sudo split -l 5 split_door_4aj split_door_5

┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ canplayer -I split_door_5aa
</pre></table></code></div></div><p>From the final file obtained, such as <code class="language-plaintext highlighter-rouge">split_door_5aa</code>, you can examine the CAN frames it contains. To verify which CAN frame opens the back left door, you can use the <code class="language-plaintext highlighter-rouge">cansend</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ cat split_door_5aa               
(1684479566.160076) vcan0 1B0#000F0000000157
(1684479566.160079) vcan0 1D0#000000000000000A
(1684479566.160118) vcan0 19B#00000B000000
(1684479566.160124) vcan0 244#000000017C
(1684479566.161172) vcan0 166#D0320027
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ cansend vcan0 1B0#000F0000000157
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ cansend vcan0 1D0#000000000000000A
                                                                                                           
┌──(kali㉿kali)-[/opt/ICSim/split]
└─$ cansend vcan0 19B#00000B000000  
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://github.com/am-a-circle/am-a-circle.github.io/blob/main/assets/img/carstuff/post2/found_split.jpg?raw=true" alt="enter image description here" /></p><p>By sending these specific CAN frames, you can observe the corresponding action of the back left door opening.</p><p>Therefore, based on the iterative splitting process, it is determined that the CAN frame <code class="language-plaintext highlighter-rouge">19B#00000B000000</code> is responsible for opening the back left door of the car.</p><h2 id="find-can-frames-by-can-sniff-method-for-all-controls">Find CAN frames by CAN Sniff Method for all controls</h2><p>In this section, we will utilize the cansniffer tool to sniff CAN frames and identify various controls within the system.</p><p>Upon running the cansniffer tool, we can observe the changing packets highlighted in red. By closely monitoring these packets, we can determine which message identifiers correspond to specific controller actions.</p><p>To begin, let’s analyze the results from our previous attack. We discovered that the message identifier for door opening was 19B. Let’s continue our exploration from this point.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt/ICSim]                                                                         
└─$ cansniffer -c vcan0 
06|ms | ID  | data ...     &lt; vcan0 # l=20 h=100 t=500 slots=37 &gt;                                   
00013 | 039 | 00 39                   .9
00009 | 095 | 80 00 07 F4 00 00 00 08 ........
00011 | 133 | 00 00 00 00 A7          .....
00011 | 136 | 00 02 00 00 00 00 00 2A .......*
00009 | 13A | 00 00 00 00 00 00 00 28 .......(
00009 | 13F | 00 00 00 05 00 00 00 2E ........
00011 | 143 | 6B 6B 00 D1             kk..
00009 | 158 | 00 00 00 00 00 00 00 19 ........
00009 | 161 | 00 00 05 50 01 08 00 1C ...P....
00011 | 164 | 00 00 C0 1A A8 00 00 04 ........
00010 | 166 | D0 32 00 18             .2..
00009 | 17C | 00 00 00 00 10 00 00 21 .......!
00011 | 183 | 00 00 00 0D 00 00 10 1D ........
00009 | 18E | 00 00 6B                ..k
00011 | 191 | 01 00 10 A1 41 00 0B    ....A..
00019 | 1A4 | 00 00 00 08 00 00 00 2F ......./
00020 | 1AA | 7F FF 00 00 00 00 68 2F ......h/
00020 | 1B0 | 00 0F 00 00 00 01 66    ......f
00020 | 1CF | 80 05 00 00 00 1E       ......
00021 | 1DC | 02 00 00 1B             ....
00038 | 21E | 03 E8 37 45 22 06 2F    ..7E"./
00013 | 244 | 00 00 00 01 16          .....
00038 | 294 | 04 0B 00 02 CF 5A 00 2C .....Z.,
00103 | 305 | 80 26                   .&amp;
00099 | 309 | 00 00 00 00 00 00 00 A2 ........
00100 | 320 | 00 00 12                ...
00100 | 324 | 74 65 00 00 00 00 0E 1A te......
00098 | 333 | 00 00 00 00 00 00 1E    .......
00100 | 37C | FD 00 FD 00 09 7F 00 1A ........
00248 | 405 | 00 00 04 00 00 00 00 0B ........
00266 | 40C | 02 36 32 32 39 53 30 39 .6229S09
00245 | 428 | 01 04 00 00 52 1C 01    ....R..
00266 | 454 | 23 EF 36                #.6
00999 | 5A1 | 96 00 00 00 00 00 62 3E ......b&gt;
</pre></table></code></div></div><p>To further validate our findings, let’s simulate the action of opening the left two doors. We can observe that the message identifier 19B appears in the output, whereas it was absent in the previous code. From the output, we can see the sequence: <code class="language-plaintext highlighter-rouge">00 00 0A 00 00 00</code>. Thus this CAN frame is used to open the left two doors of the car.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>95|ms | ID  | data ...     &lt; vcan0 # l=20 h=100 t=500 slots=37 &gt; 
00014 | 039 | 00 0C                   ..
00009 | 095 | 80 00 07 F8 00 00 00 04 ........
00010 | 133 | 00 00 00 00 98          .....
00010 | 136 | 00 02 00 00 00 00 00 1B ........
00010 | 13A | 00 00 00 00 00 00 00 19 ........
00010 | 13F | 00 00 00 05 00 00 00 1F ........
00010 | 143 | 6B 6B 00 D1             kk..
00010 | 158 | 00 00 00 00 00 00 00 0A ........
00010 | 161 | 00 00 05 50 01 08 00 0D ...P....
00010 | 164 | 00 00 C0 1A A8 00 00 31 .......1
00011 | 166 | D0 32 00 18             .2..
00010 | 17C | 00 00 00 00 10 00 00 12 ........
00010 | 183 | 00 00 00 09 00 00 10 11 ........
00010 | 18E | 00 00 5C                ..\
00010 | 191 | 01 00 10 A1 41 00 38    ....A.8
00096 | 19B | 00 00 0A 00 00 00       ......
00018 | 1A4 | 00 00 00 08 00 00 00 2F ......./
00020 | 1AA | 7F FF 00 00 00 00 68 2F ......h/
00020 | 1B0 | 00 0F 00 00 00 01 66    ......f
00019 | 1CF | 80 05 00 00 00 0F       ......
00019 | 1DC | 02 00 00 0C             ....
00040 | 21E | 03 E8 37 45 22 06 01    ..7E"..
00012 | 244 | 00 00 00 01 48          ....H
00040 | 294 | 04 0B 00 02 CF 5A 00 0E .....Z..
00104 | 305 | 80 08                   ..
00098 | 309 | 00 00 00 00 00 00 00 84 ........
00099 | 320 | 00 00 30                ..0
00099 | 324 | 74 65 00 00 00 00 0E 38 te.....8
00101 | 333 | 00 00 00 00 00 00 3C    ......&lt;
00099 | 37C | FD 00 FD 00 09 7F 00 38 .......8
00296 | 405 | 00 00 04 00 00 00 00 29 .......)
00300 | 40C | 00 00 00 00 04 00 00 13 ........
00300 | 428 | 01 04 00 00 52 1C 2F    ....R./
00300 | 454 | 23 EF 18                #..
01261 | 5A1 | 96 00 00 00 00 00 62 10 ......b.
</pre></table></code></div></div><p>We can verify this by running the command below:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[/opt]
└─$ cansend vcan0 19B#00000A000000 
</pre></table></code></div></div><p>Based on the observations and experiments, we have identified a list of commands that correspond to specific actions. These commands have been verified using the <code class="language-plaintext highlighter-rouge">cansend</code> tool:</p><ul><li>To open the back right door: <code class="language-plaintext highlighter-rouge">cansend vcan0 19B#000007000000</code><li>To open the back left door: <code class="language-plaintext highlighter-rouge">cansend vcan0 19B#00000B000000</code><li>To open the right two doors: <code class="language-plaintext highlighter-rouge">cansend vcan0 19B#000005000000</code><li>To open the left two doors: <code class="language-plaintext highlighter-rouge">cansend vcan0 19B#00000A000000</code><li>To close all doors: <code class="language-plaintext highlighter-rouge">cansend vcan0 19B#00000F000000</code><li>To trigger a right turn signal: <code class="language-plaintext highlighter-rouge">cansend vcan0 188#020000000000</code><li>To trigger a left turn signal: <code class="language-plaintext highlighter-rouge">cansend vcan0 188#010000000000</code></ul><p>Feel free to experiment with these commands to control the various functions of the vehicle.</p><h2 id="conclusion">Conclusion</h2><p>In conclusion, setting up can-utils and connecting to CAN devices is an essential step in car penetration testing. In this post, we learned how to install and configure can-utils on a Kali Linux instance, as well as explored some of the can-utils tools available.</p><p>We also discovered how to set up a virtual CAN network using the vcan module. Additionally, we explored the instrument cluster simulator (ICSim) and its role in simulating realistic background noise for practicing CAN bus reversing. We then delved into dumping CAN frames and performing a replay attack using the candump and canplayer tools.</p><p>Finally, we explored the Recursive Splitting Method to identify a specific CAN frame responsible for a particular action. By following these steps, we can gain valuable insights into the inner workings of CAN networks and improve our understanding of automotive cybersecurity. With this knowledge, we can contribute to securing vehicles in the digital age and effectively identify vulnerabilities and potential attack vectors.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogs/'>Blogs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pentest/" class="post-tag no-text-decoration" >Pentest</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automobile Hacking - Part 2 - am-a-circle&url=https://am-a-circle.github.io//posts/CarPT-Part2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automobile Hacking - Part 2 - am-a-circle&u=https://am-a-circle.github.io//posts/CarPT-Part2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Automobile Hacking - Part 2 - am-a-circle&url=https://am-a-circle.github.io//posts/CarPT-Part2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CarPT-Part1/">Automobile Hacking - Part 1</a><li><a href="/posts/CarPT-Part2/">Automobile Hacking - Part 2</a><li><a href="/posts/CRTP/">Attacking and Defending Active Directory Lab Course</a><li><a href="/posts/goals/">Goals</a><li><a href="/posts/speed/">Speed</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CarPT-Part1/"><div class="card-body"> <span class="timeago small" >May 10, 2023<i class="unloaded">2023-05-10T09:50:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Automobile Hacking - Part 1</h3><div class="text-muted small"><p> Automotive Penetration Testing Welcome to the first of many blog posts in the world of car penetration testing! As vehicles continue to integrate electronic systems, software, and network connecti...</p></div></div></a></div><div class="card"> <a href="/posts/CarResource/"><div class="card-body"> <span class="timeago small" >May 10, 2023<i class="unloaded">2023-05-10T09:50:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Automobile Hacking Resource</h3><div class="text-muted small"><p> All in one resources Awesome Canbus - This curated list helps a reverse engineering CAN bus devices with lightly specializing in automotive embedded controller software and communication underst...</p></div></div></a></div><div class="card"> <a href="/posts/CRTP/"><div class="card-body"> <span class="timeago small" >May 4, 2022<i class="unloaded">2022-05-04T18:50:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking and Defending Active Directory Lab Course</h3><div class="text-muted small"><p> Overview Recently took on the CRTP course and passed the exam ! Definitely a great introductory course to learn more about the approach of attacking and defending Active Directory. Some review t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CarResource/" class="btn btn-outline-primary" prompt="Older"><p>Automobile Hacking Resource</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/am-a-circle">am-a-circle</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
